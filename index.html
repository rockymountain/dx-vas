
<!DOCTYPE html>

<html class="no-js" lang="vi">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tài liệu kiến trúc và phát triển cho dự án Chuyển đổi số Trường Việt Anh (dx_vas)." name="description"/>
<meta content="DX VAS Team" name="author"/>
<link href="https://dx.truongvietanh.edu.vn/" rel="canonical"/>
<link href="." rel="prev"/>
<link href="architecture/system-diagrams/" rel="next"/>
<link href="assets/images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.14" name="generator"/>
<title>Home - DX VAS - Docs</title>
<link href="assets/stylesheets/main.342714a4.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="pink" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#tai-lieu-kien-truc-chi-tiet-he-thong-chuyen-oi-so-vas">
          Bỏ qua
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Đầu trang" class="md-header__inner md-grid">
<a aria-label="DX VAS - Docs" class="md-header__button md-logo" data-md-component="logo" href="." title="DX VAS - Docs">
<img alt="logo" src="assets/images/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            DX VAS - Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Home
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="pink" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="lime" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Tìm kiếm" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Tìm kiếm" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Tìm kiếm" class="md-search__options">
<button aria-label="Xoá" class="md-search__icon md-icon" tabindex="-1" title="Xoá" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/rockymountain/dx-vas.git" title="Xem mã nguồn">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    rockymountain/dx-vas
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href=".">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href=".">
          
  
  
    
  
  Kiến trúc Hệ thống

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="dev/dev-guide/">
          
  
  
    
  
  Hướng dẫn Phát triển

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="services/user-service/design/">
          
  
  
    
  
  Thiết kế Services

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="ADR/">
          
  
  
    
  
  Quyết định Kiến trúc (ADRs)

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Thanh điều hướng" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="DX VAS - Docs" class="md-nav__button md-logo" data-md-component="logo" href="." title="DX VAS - Docs">
<img alt="logo" src="assets/images/logo.png"/>
</a>
    DX VAS - Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/rockymountain/dx-vas.git" title="Xem mã nguồn">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    rockymountain/dx-vas
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Home
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href=".">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
<nav aria-label="Mục lục" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Mục lục
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-yeu-cau-du-an">
<span class="md-ellipsis">
      1. Yêu cầu dự án
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-ang-nhap-phan-quyen-ong-rbac">
<span class="md-ellipsis">
      2. Đăng nhập &amp; Phân quyền động (RBAC)
    </span>
</a>
<nav aria-label="2. Đăng nhập &amp; Phân quyền động (RBAC)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mo-hinh-phan-tang-inh-danh-va-rbac">
<span class="md-ellipsis">
      🔑 Mô hình phân tầng định danh và RBAC
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#anh-gia-phan-quyen-tai-api-gateway">
<span class="md-ellipsis">
      🔐 Đánh giá phân quyền tại API Gateway
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tinh-linh-hoat">
<span class="md-ellipsis">
      🧭 Tính linh hoạt
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-auth-service">
<span class="md-ellipsis">
      3. Auth Service
    </span>
</a>
<nav aria-label="3. Auth Service" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#auth-service-master">
<span class="md-ellipsis">
      🔐 Auth Service Master
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sub-auth-service-per-tenant">
<span class="md-ellipsis">
      🔐 Sub Auth Service (per tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tinh-nang-bao-mat-nang-cao">
<span class="md-ellipsis">
      🔐 Tính năng bảo mật nâng cao
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y-ve-trien-khai">
<span class="md-ellipsis">
      🎯 Lưu ý về triển khai:
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-user-service">
<span class="md-ellipsis">
      4. User Service
    </span>
</a>
<nav aria-label="4. User Service" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#user-service-master-tap-trung-toan-he-thong">
<span class="md-ellipsis">
      🧠 User Service Master (Tập trung toàn hệ thống)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sub-user-service-cap-tenant-uoc-trien-khai-trong-tung-stack-tenant">
<span class="md-ellipsis">
      🧩 Sub User Service (Cấp tenant – được triển khai trong từng stack tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#co-che-hoat-ong-ien-hinh">
<span class="md-ellipsis">
      🔄 Cơ chế hoạt động điển hình:
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-api-gateway">
<span class="md-ellipsis">
      5. API Gateway
    </span>
</a>
<nav aria-label="5. API Gateway" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#inh-tuyen-theo-tenant">
<span class="md-ellipsis">
      🧭 Định tuyến theo Tenant
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-tra-rbac-ong-theo-tenant">
<span class="md-ellipsis">
      🔐 Kiểm tra RBAC động theo tenant
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forward-request">
<span class="md-ellipsis">
      📦 Forward request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bao-ve-noi-dung-inh-danh">
<span class="md-ellipsis">
      🔐 Bảo vệ nội dung &amp; định danh
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-notification-service-multi-tenant-option-b">
<span class="md-ellipsis">
      6. Notification Service (Multi-Tenant – Option B)
    </span>
</a>
<nav aria-label="6. Notification Service (Multi-Tenant – Option B)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#phan-tang-dich-vu">
<span class="md-ellipsis">
      🧭 Phân tầng dịch vụ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luong-gui-thong-bao-toan-he-thong-option-b-event-based">
<span class="md-ellipsis">
      🔄 Luồng gửi thông báo toàn hệ thống (Option B – Event-based)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#co-che-phong-ngua-rui-ro">
<span class="md-ellipsis">
      ✅ Cơ chế phòng ngừa rủi ro
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-superadmin-webapp-spa">
<span class="md-ellipsis">
      7. Superadmin Webapp (SPA)
    </span>
</a>
<nav aria-label="7. Superadmin Webapp (SPA)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#chuc-nang-chinh">
<span class="md-ellipsis">
      🏛️ Chức năng chính
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cong-nghe-tich-hop">
<span class="md-ellipsis">
      🛠 Công nghệ &amp; tích hợp
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-ha-tang-trien-khai">
<span class="md-ellipsis">
      8. Hạ tầng triển khai
    </span>
</a>
<nav aria-label="8. Hạ tầng triển khai" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mo-hinh-trien-khai">
<span class="md-ellipsis">
      🧱 Mô hình triển khai
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cau-truc-project-gcp-e-xuat">
<span class="md-ellipsis">
      ⚙️ Cấu trúc Project GCP đề xuất
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-cong-nghe-ha-tang-su-dung">
<span class="md-ellipsis">
      ☁️ Các công nghệ hạ tầng sử dụng
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-admin-webapp-spa-cap-o-tenant">
<span class="md-ellipsis">
      9. Admin Webapp - SPA (cấp độ tenant)
    </span>
</a>
<nav aria-label="9. Admin Webapp - SPA (cấp độ tenant)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ac-iem">
<span class="md-ellipsis">
      🧩 Đặc điểm
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chuc-nang-chinh-theo-vai-tro">
<span class="md-ellipsis">
      🛠 Chức năng chính theo vai trò
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phan-quyen-bao-mat-noi-bo">
<span class="md-ellipsis">
      🔒 Phân quyền &amp; bảo mật nội bộ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-customer-portal-pwa-cap-o-tenant">
<span class="md-ellipsis">
      10. Customer Portal - PWA (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#11-crm-suitecrm-cap-o-tenant">
<span class="md-ellipsis">
      11. CRM – SuiteCRM (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12-sis-gibbon-cap-o-tenant">
<span class="md-ellipsis">
      12. SIS – Gibbon (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#13-lms-moodle-cap-o-tenant">
<span class="md-ellipsis">
      13. LMS – Moodle (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#14-notification-service">
<span class="md-ellipsis">
      14. Notification Service
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#15-zalo-oa-google-chat">
<span class="md-ellipsis">
      15. Zalo OA &amp; Google Chat
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#16-cicd-devops">
<span class="md-ellipsis">
      16. CI/CD &amp; DevOps
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#17-bao-mat-giam-sat">
<span class="md-ellipsis">
      17. Bảo mật &amp; Giám sát
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#18-data-migration-plan">
<span class="md-ellipsis">
      18. Data Migration Plan
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#19-ao-tao-chuyen-giao">
<span class="md-ellipsis">
      19. Đào tạo &amp; Chuyển giao
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#20-tong-ket">
<span class="md-ellipsis">
      20. Tổng kết
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-a-danh-sach-quyet-inh-kien-truc-adrs">
<span class="md-ellipsis">
      Phụ lục A – Danh sách Quyết định Kiến trúc (ADRs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-b-nguyen-tac-kien-truc-cot-loi">
<span class="md-ellipsis">
      Phụ lục B – Nguyên tắc Kiến trúc Cốt lõi
    </span>
</a>
<nav aria-label="Phụ lục B – Nguyên tắc Kiến trúc Cốt lõi" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#bo-sung-nguyen-tac-cho-multi-tenant">
<span class="md-ellipsis">
      ✨ Bổ sung nguyên tắc cho Multi-Tenant
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-c-so-o-kien-truc">
<span class="md-ellipsis">
      Phụ lục C – Sơ đồ Kiến trúc
    </span>
</a>
<nav aria-label="Phụ lục C – Sơ đồ Kiến trúc" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#so-o-tong-quan-kien-truc-multi-tenant">
<span class="md-ellipsis">
      🧭 Sơ đồ tổng quan kiến trúc multi-tenant
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-d-interface-contracts-ics">
<span class="md-ellipsis">
      Phụ lục D – Interface Contracts (ICs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-e-huong-dan-ong-gop-phat-trien">
<span class="md-ellipsis">
      Phụ lục E – Hướng dẫn đóng góp &amp; phát triển
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link md-nav__link--active" href=".">
<span class="md-ellipsis">
    Kiến trúc Hệ thống
    
  </span>
</a>
<label class="md-nav__link md-nav__link--active" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Kiến trúc Hệ thống
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="architecture/system-diagrams/">
<span class="md-ellipsis">
    Sơ đồ Hệ thống
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="architecture/rbac-deep-dive/">
<span class="md-ellipsis">
    RBAC Chi tiết
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Hướng dẫn Phát triển
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Hướng dẫn Phát triển
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="dev/dev-guide/">
<span class="md-ellipsis">
    Tổng quan Phát triển (Dev Guide)
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="dev/backend-dev-guide/">
<span class="md-ellipsis">
    Backend Dev Guide
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="dev/ops-guide/">
<span class="md-ellipsis">
    Vận hành &amp; DevOps (Ops Guide)
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Thiết kế Services
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Thiết kế Services
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
<span class="md-ellipsis">
    User Service
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
            User Service
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="services/user-service/design/">
<span class="md-ellipsis">
    Tổng quan Thiết kế
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="services/user-service/interface-contract/">
<span class="md-ellipsis">
    Hợp đồng Giao diện
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="services/user-service/data-model/">
<span class="md-ellipsis">
    Mô hình Dữ liệu
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="services/user-service/openapi.yaml">
<span class="md-ellipsis">
    Đặc tả OpenAPI
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="ADR/">
<span class="md-ellipsis">
    Quyết định Kiến trúc (ADRs)
    
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Quyết định Kiến trúc (ADRs)
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Mục lục" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Mục lục
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-yeu-cau-du-an">
<span class="md-ellipsis">
      1. Yêu cầu dự án
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-ang-nhap-phan-quyen-ong-rbac">
<span class="md-ellipsis">
      2. Đăng nhập &amp; Phân quyền động (RBAC)
    </span>
</a>
<nav aria-label="2. Đăng nhập &amp; Phân quyền động (RBAC)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mo-hinh-phan-tang-inh-danh-va-rbac">
<span class="md-ellipsis">
      🔑 Mô hình phân tầng định danh và RBAC
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#anh-gia-phan-quyen-tai-api-gateway">
<span class="md-ellipsis">
      🔐 Đánh giá phân quyền tại API Gateway
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tinh-linh-hoat">
<span class="md-ellipsis">
      🧭 Tính linh hoạt
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-auth-service">
<span class="md-ellipsis">
      3. Auth Service
    </span>
</a>
<nav aria-label="3. Auth Service" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#auth-service-master">
<span class="md-ellipsis">
      🔐 Auth Service Master
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sub-auth-service-per-tenant">
<span class="md-ellipsis">
      🔐 Sub Auth Service (per tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tinh-nang-bao-mat-nang-cao">
<span class="md-ellipsis">
      🔐 Tính năng bảo mật nâng cao
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y-ve-trien-khai">
<span class="md-ellipsis">
      🎯 Lưu ý về triển khai:
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-user-service">
<span class="md-ellipsis">
      4. User Service
    </span>
</a>
<nav aria-label="4. User Service" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#user-service-master-tap-trung-toan-he-thong">
<span class="md-ellipsis">
      🧠 User Service Master (Tập trung toàn hệ thống)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sub-user-service-cap-tenant-uoc-trien-khai-trong-tung-stack-tenant">
<span class="md-ellipsis">
      🧩 Sub User Service (Cấp tenant – được triển khai trong từng stack tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#co-che-hoat-ong-ien-hinh">
<span class="md-ellipsis">
      🔄 Cơ chế hoạt động điển hình:
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-api-gateway">
<span class="md-ellipsis">
      5. API Gateway
    </span>
</a>
<nav aria-label="5. API Gateway" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#inh-tuyen-theo-tenant">
<span class="md-ellipsis">
      🧭 Định tuyến theo Tenant
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-tra-rbac-ong-theo-tenant">
<span class="md-ellipsis">
      🔐 Kiểm tra RBAC động theo tenant
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forward-request">
<span class="md-ellipsis">
      📦 Forward request
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bao-ve-noi-dung-inh-danh">
<span class="md-ellipsis">
      🔐 Bảo vệ nội dung &amp; định danh
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-notification-service-multi-tenant-option-b">
<span class="md-ellipsis">
      6. Notification Service (Multi-Tenant – Option B)
    </span>
</a>
<nav aria-label="6. Notification Service (Multi-Tenant – Option B)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#phan-tang-dich-vu">
<span class="md-ellipsis">
      🧭 Phân tầng dịch vụ
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luong-gui-thong-bao-toan-he-thong-option-b-event-based">
<span class="md-ellipsis">
      🔄 Luồng gửi thông báo toàn hệ thống (Option B – Event-based)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#co-che-phong-ngua-rui-ro">
<span class="md-ellipsis">
      ✅ Cơ chế phòng ngừa rủi ro
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-superadmin-webapp-spa">
<span class="md-ellipsis">
      7. Superadmin Webapp (SPA)
    </span>
</a>
<nav aria-label="7. Superadmin Webapp (SPA)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#chuc-nang-chinh">
<span class="md-ellipsis">
      🏛️ Chức năng chính
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cong-nghe-tich-hop">
<span class="md-ellipsis">
      🛠 Công nghệ &amp; tích hợp
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-ha-tang-trien-khai">
<span class="md-ellipsis">
      8. Hạ tầng triển khai
    </span>
</a>
<nav aria-label="8. Hạ tầng triển khai" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mo-hinh-trien-khai">
<span class="md-ellipsis">
      🧱 Mô hình triển khai
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cau-truc-project-gcp-e-xuat">
<span class="md-ellipsis">
      ⚙️ Cấu trúc Project GCP đề xuất
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-cong-nghe-ha-tang-su-dung">
<span class="md-ellipsis">
      ☁️ Các công nghệ hạ tầng sử dụng
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-admin-webapp-spa-cap-o-tenant">
<span class="md-ellipsis">
      9. Admin Webapp - SPA (cấp độ tenant)
    </span>
</a>
<nav aria-label="9. Admin Webapp - SPA (cấp độ tenant)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ac-iem">
<span class="md-ellipsis">
      🧩 Đặc điểm
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chuc-nang-chinh-theo-vai-tro">
<span class="md-ellipsis">
      🛠 Chức năng chính theo vai trò
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phan-quyen-bao-mat-noi-bo">
<span class="md-ellipsis">
      🔒 Phân quyền &amp; bảo mật nội bộ
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-customer-portal-pwa-cap-o-tenant">
<span class="md-ellipsis">
      10. Customer Portal - PWA (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#11-crm-suitecrm-cap-o-tenant">
<span class="md-ellipsis">
      11. CRM – SuiteCRM (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12-sis-gibbon-cap-o-tenant">
<span class="md-ellipsis">
      12. SIS – Gibbon (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#13-lms-moodle-cap-o-tenant">
<span class="md-ellipsis">
      13. LMS – Moodle (cấp độ tenant)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#14-notification-service">
<span class="md-ellipsis">
      14. Notification Service
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#15-zalo-oa-google-chat">
<span class="md-ellipsis">
      15. Zalo OA &amp; Google Chat
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#16-cicd-devops">
<span class="md-ellipsis">
      16. CI/CD &amp; DevOps
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#17-bao-mat-giam-sat">
<span class="md-ellipsis">
      17. Bảo mật &amp; Giám sát
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#18-data-migration-plan">
<span class="md-ellipsis">
      18. Data Migration Plan
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#19-ao-tao-chuyen-giao">
<span class="md-ellipsis">
      19. Đào tạo &amp; Chuyển giao
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#20-tong-ket">
<span class="md-ellipsis">
      20. Tổng kết
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-a-danh-sach-quyet-inh-kien-truc-adrs">
<span class="md-ellipsis">
      Phụ lục A – Danh sách Quyết định Kiến trúc (ADRs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-b-nguyen-tac-kien-truc-cot-loi">
<span class="md-ellipsis">
      Phụ lục B – Nguyên tắc Kiến trúc Cốt lõi
    </span>
</a>
<nav aria-label="Phụ lục B – Nguyên tắc Kiến trúc Cốt lõi" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#bo-sung-nguyen-tac-cho-multi-tenant">
<span class="md-ellipsis">
      ✨ Bổ sung nguyên tắc cho Multi-Tenant
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-c-so-o-kien-truc">
<span class="md-ellipsis">
      Phụ lục C – Sơ đồ Kiến trúc
    </span>
</a>
<nav aria-label="Phụ lục C – Sơ đồ Kiến trúc" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#so-o-tong-quan-kien-truc-multi-tenant">
<span class="md-ellipsis">
      🧭 Sơ đồ tổng quan kiến trúc multi-tenant
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-d-interface-contracts-ics">
<span class="md-ellipsis">
      Phụ lục D – Interface Contracts (ICs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phu-luc-e-huong-dan-ong-gop-phat-trien">
<span class="md-ellipsis">
      Phụ lục E – Hướng dẫn đóng góp &amp; phát triển
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="tai-lieu-kien-truc-chi-tiet-he-thong-chuyen-oi-so-vas">TÀI LIỆU KIẾN TRÚC CHI TIẾT – HỆ THỐNG CHUYỂN ĐỔI SỐ VAS<a class="headerlink" href="#tai-lieu-kien-truc-chi-tiet-he-thong-chuyen-oi-so-vas" title="Permanent link">¶</a></h1>
<h2 id="1-yeu-cau-du-an">1. Yêu cầu dự án<a class="headerlink" href="#1-yeu-cau-du-an" title="Permanent link">¶</a></h2>
<ul>
<li>
<p><strong>Mục tiêu chính:</strong> Triển khai một hệ thống chuyển đổi số toàn diện cho một công ty giáo dục quản lý nhiều trường thành viên, tích hợp quản lý học sinh, giáo viên, phụ huynh, lớp học, học phí, thông báo, học tập online và quy trình tuyển sinh.</p>
</li>
<li>
<p><strong>Mô hình vận hành:</strong> </p>
</li>
<li>Công ty sở hữu và quản lý <strong>3 trường thành viên</strong> (mỗi trường là một tenant riêng biệt).</li>
<li>
<p>Hệ thống vận hành theo kiến trúc <strong>multi-tenant</strong>, mỗi tenant có stack riêng (frontend, adapters, auth/user sub-service), và dùng chung API Gateway &amp; Tenant Master Services.</p>
</li>
<li>
<p><strong>Thiết kế ban đầu (cho toàn hệ thống):</strong></p>
</li>
<li>1 công ty quản lý 3 tenant (trường thành viên).</li>
<li>
<p>Tổng số người dùng dự kiến:</p>
<ul>
<li><strong>100 nhân viên, giáo viên</strong> (toàn hệ thống)</li>
<li><strong>Từ 100 đến 600 học sinh mỗi trường</strong> → tổng cộng <strong>khoảng 1000 học sinh</strong></li>
<li><strong>Khoảng 1000 phụ huynh</strong>, tương ứng 1:1 với học sinh</li>
</ul>
</li>
<li>
<p><strong>Khả năng mở rộng tối đa (gấp 2.5 lần):</strong></p>
</li>
<li><strong>250 nhân viên, giáo viên</strong></li>
<li><strong>Tối đa 2500 học sinh</strong></li>
<li><strong>Tối đa 2500 phụ huynh</strong></li>
</ul>
<h2 id="2-ang-nhap-phan-quyen-ong-rbac">2. Đăng nhập &amp; Phân quyền động (RBAC)<a class="headerlink" href="#2-ang-nhap-phan-quyen-ong-rbac" title="Permanent link">¶</a></h2>
<p>Hệ thống dx-vas sử dụng kiến trúc RBAC động với khả năng multi-tenant. Quyền truy cập được kiểm soát chính xác theo từng tenant (trường thành viên), kết hợp quản trị tập trung từ Master với khả năng tùy biến cục bộ tại từng tenant.</p>
<h3 id="mo-hinh-phan-tang-inh-danh-va-rbac">🔑 Mô hình phân tầng định danh và RBAC<a class="headerlink" href="#mo-hinh-phan-tang-inh-danh-va-rbac" title="Permanent link">¶</a></h3>
<ul>
<li><strong>User Service Master</strong>:</li>
<li>Quản lý toàn bộ định danh người dùng (<code>users_global</code>)</li>
<li>Duy trì thông tin <code>tenants</code>, <code>user_tenant_assignments</code></li>
<li>Cung cấp bộ <code>global_roles_templates</code> và <code>global_permissions_templates</code></li>
<li>
<p>Trạng thái <code>is_active</code> toàn cục</p>
</li>
<li>
<p><strong>Sub User Service (per tenant)</strong>:</p>
</li>
<li>Quản lý RBAC riêng biệt của tenant</li>
<li>Tham chiếu <code>user_id_global</code>, có <code>is_active_in_tenant</code></li>
<li>Cho phép kế thừa hoặc tuỳ chỉnh role/permission riêng</li>
<li>Thực hiện gán vai trò, phân quyền, và kiểm tra RBAC trong nội bộ tenant</li>
</ul>
<p>📘 Mọi chi tiết về schema, bảng, quan hệ được định nghĩa rõ trong:
- <a href="./services/user-service/master/data-model.md"><code>user-service/master/data-model.md</code></a>
- <a href="./services/user-service/tenant/data-model.md"><code>user-service/tenant/data-model.md</code></a></p>
<h3 id="anh-gia-phan-quyen-tai-api-gateway">🔐 Đánh giá phân quyền tại API Gateway<a class="headerlink" href="#anh-gia-phan-quyen-tai-api-gateway" title="Permanent link">¶</a></h3>
<ul>
<li>JWT do Auth Master/Sub cấp, chứa <code>user_id</code>, <code>tenant_id</code>, <code>roles</code>, <code>permissions</code></li>
<li>Gateway thực hiện:</li>
<li>Xác thực JWT</li>
<li>Kiểm tra <code>is_active</code> và <code>is_active_in_tenant</code></li>
<li>Truy vấn cache RBAC (theo <code>user_id + tenant_id</code>)</li>
<li>Đánh giá điều kiện JSONB nếu có (VD: xem điểm học sinh nếu cùng lớp)</li>
</ul>
<h3 id="tinh-linh-hoat">🧭 Tính linh hoạt<a class="headerlink" href="#tinh-linh-hoat" title="Permanent link">¶</a></h3>
<ul>
<li>Một user có thể thuộc nhiều tenant với vai trò khác nhau</li>
<li>Tenant có thể chỉnh sửa RBAC riêng mà không ảnh hưởng các tenant khác</li>
<li>RBAC cache tại Gateway được đồng bộ qua Pub/Sub hoặc TTL tự động</li>
</ul>
<p>📘 Đọc thêm mô hình phân quyền chi tiết tại: <a href="architecture/rbac-deep-dive/"><code>rbac-deep-dive.md</code></a></p>
<h2 id="3-auth-service">3. Auth Service<a class="headerlink" href="#3-auth-service" title="Permanent link">¶</a></h2>
<p>Hệ thống dx-vas sử dụng mô hình xác thực đa tầng để hỗ trợ multi-tenant, đồng thời đảm bảo tính linh hoạt trong xác thực Google OAuth2 và Local/OTP.</p>
<h3 id="auth-service-master">🔐 Auth Service Master<a class="headerlink" href="#auth-service-master" title="Permanent link">¶</a></h3>
<ul>
<li>Chịu trách nhiệm xử lý xác thực thông qua Google OAuth2 cho toàn bộ hệ thống.</li>
<li>Sau khi người dùng xác thực thành công qua Google, hệ thống sẽ:</li>
<li>Xác định danh sách các tenant mà người dùng thuộc về.</li>
<li>Nếu người dùng thuộc nhiều tenant, hiển thị giao diện chọn tenant.</li>
<li>Gọi User Service Master để kiểm tra <code>user_id_global</code>, và xác thực xem người dùng có quyền truy cập tenant đã chọn không.</li>
<li>Gọi Sub User Service (của tenant đó) để lấy danh sách roles/permissions trong tenant.</li>
<li>Phát hành JWT "đầy đủ" chứa:<ul>
<li><code>user_id</code></li>
<li><code>tenant_id</code></li>
<li><code>roles</code>, <code>permissions</code></li>
<li><code>auth_provider</code>, <code>exp</code>, <code>trace_id</code>…</li>
</ul>
</li>
</ul>
<h3 id="sub-auth-service-per-tenant">🔐 Sub Auth Service (per tenant)<a class="headerlink" href="#sub-auth-service-per-tenant" title="Permanent link">¶</a></h3>
<ul>
<li>Triển khai riêng biệt trong từng tenant stack.</li>
<li>Xử lý xác thực cho các user sử dụng:</li>
<li>Tài khoản Local (tên đăng nhập/mật khẩu)</li>
<li>OTP (SMS/email)</li>
<li>Sau khi xác thực local thành công:</li>
<li>Gọi User Service Master để đăng ký người dùng (nếu lần đầu) và nhận <code>user_id_global</code>.</li>
<li>Gọi Sub User Service của chính tenant để lấy RBAC tương ứng.</li>
<li>Phát hành JWT đầy đủ như Auth Master.</li>
</ul>
<h3 id="tinh-nang-bao-mat-nang-cao">🔐 Tính năng bảo mật nâng cao<a class="headerlink" href="#tinh-nang-bao-mat-nang-cao" title="Permanent link">¶</a></h3>
<ul>
<li>Cơ chế CAPTCHA và giới hạn số lần gửi OTP theo IP/user.</li>
<li>JWT ký bằng key được luân phiên định kỳ (theo chính sách <a href="ADR/adr-006-auth-strategy/"><code>ADR-006</code></a>).</li>
<li>Hỗ trợ đăng xuất, làm mới token (refresh), kiểm tra trace log đăng nhập.</li>
</ul>
<h3 id="luu-y-ve-trien-khai">🎯 Lưu ý về triển khai:<a class="headerlink" href="#luu-y-ve-trien-khai" title="Permanent link">¶</a></h3>
<ul>
<li>Mỗi tenant có thể dùng Sub Auth Service tùy chọn (bắt buộc nếu có học sinh/phụ huynh không dùng Workspace).</li>
<li>Tất cả JWT (kể cả từ Sub Auth) đều phải tuân thủ format chuẩn và có thể được xác minh bởi API Gateway.</li>
</ul>
<p>📘 Xem thêm: <a href="ADR/adr-006-auth-strategy/">ADR-006 – Auth Strategy</a></p>
<h2 id="4-user-service">4. User Service<a class="headerlink" href="#4-user-service" title="Permanent link">¶</a></h2>
<p>User Service trong hệ thống dx-vas được chia thành hai cấp độ để hỗ trợ kiến trúc multi-tenant:</p>
<h3 id="user-service-master-tap-trung-toan-he-thong">🧠 User Service Master (Tập trung toàn hệ thống)<a class="headerlink" href="#user-service-master-tap-trung-toan-he-thong" title="Permanent link">¶</a></h3>
<ul>
<li>Là nơi <strong>quản lý định danh người dùng toàn cục</strong>:</li>
<li>Bảng <code>users_global</code>: mỗi user có một <code>user_id</code> duy nhất toàn hệ thống, kèm <code>auth_provider</code>, <code>email</code>, <code>phone</code>, <code>local_auth_tenant_id</code> (nếu là user local).</li>
<li>Bảng <code>tenants</code>: danh sách tenant (trường thành viên) đang hoạt động.</li>
<li>Bảng <code>user_tenant_assignments</code>: ánh xạ user ↔ tenant (người dùng có thể thuộc nhiều tenant).</li>
<li>Trạng thái <code>is_active</code> toàn cục.</li>
<li>Quản lý bộ <strong>template role/permission</strong> dùng chung toàn hệ thống (<code>global_roles_templates</code>, <code>global_permissions_templates</code>).</li>
<li>Phát sự kiện Pub/Sub (<code>user_assigned_to_tenant</code>, <code>user_info_updated</code>) để đồng bộ xuống Sub User Service.</li>
<li>Cung cấp API quản trị cho Superadmin:</li>
<li>Tạo tenant, gán user vào tenant, cập nhật thông tin định danh chung.</li>
</ul>
<h3 id="sub-user-service-cap-tenant-uoc-trien-khai-trong-tung-stack-tenant">🧩 Sub User Service (Cấp tenant – được triển khai trong từng stack tenant)<a class="headerlink" href="#sub-user-service-cap-tenant-uoc-trien-khai-trong-tung-stack-tenant" title="Permanent link">¶</a></h3>
<ul>
<li>Quản lý RBAC riêng biệt cho từng tenant:</li>
<li>Bảng <code>users_in_tenant</code>: tham chiếu <code>user_id_global</code>, có <code>is_active_in_tenant</code>.</li>
<li><code>roles_in_tenant</code>, <code>permissions_in_tenant</code>: kế thừa từ Master hoặc tự định nghĩa.</li>
<li>Mapping RBAC: <code>user_role_in_tenant</code>, <code>role_permission_in_tenant</code>.</li>
<li>Truy vấn RBAC tại API Gateway dựa trên <code>user_id + tenant_id</code>.</li>
<li>Đồng bộ hóa dữ liệu từ Master thông qua Pub/Sub.</li>
<li>Cung cấp API cho Admin tenant để:</li>
<li>Gán role cho user trong tenant</li>
<li>Cập nhật trạng thái user trong tenant</li>
<li>Xem nhật ký phân quyền (nếu bật audit)</li>
</ul>
<h3 id="co-che-hoat-ong-ien-hinh">🔄 Cơ chế hoạt động điển hình:<a class="headerlink" href="#co-che-hoat-ong-ien-hinh" title="Permanent link">¶</a></h3>
<ul>
<li>Khi Superadmin gán một user vào tenant:</li>
<li>User Service Master ghi nhận và phát sự kiện <code>user_assigned_to_tenant</code></li>
<li>Sub User Service của tenant nhận sự kiện và tạo bản ghi "shadow user" nếu chưa có</li>
<li>Khi user login thành công và chọn tenant:</li>
<li>Auth Service gọi Master → kiểm tra quyền truy cập tenant</li>
<li>Gọi Sub User Service → truy vấn RBAC → trả lại để phát hành JWT</li>
</ul>
<p>📘 Xem chi tiết cấu trúc bảng và luồng tại: <a href="architecture/rbac-deep-dive/"><code>rbac-deep-dive.md</code></a>, <a href="services/user-service/data-model/"><code>user-service/data-model.md</code></a></p>
<h2 id="5-api-gateway">5. API Gateway<a class="headerlink" href="#5-api-gateway" title="Permanent link">¶</a></h2>
<p>API Gateway đóng vai trò trung tâm điều phối trong kiến trúc dx-vas, đặc biệt trong mô hình multi-tenant. Nó xử lý xác thực, phân quyền động (RBAC), định tuyến đến đúng tenant stack, và bảo vệ các backend nội bộ.</p>
<h3 id="inh-tuyen-theo-tenant">🧭 Định tuyến theo Tenant<a class="headerlink" href="#inh-tuyen-theo-tenant" title="Permanent link">¶</a></h3>
<ul>
<li>Gateway phục vụ nhiều tenant (trường thành viên) trên cùng một entrypoint.</li>
<li><strong>Tenant được xác định qua một trong ba cách:</strong></li>
<li><code>tenant_id</code> trong JWT (ưu tiên)</li>
<li>Domain/subdomain của Frontend App (VD: <code>abc.truongvietanh.edu.vn</code>)</li>
<li>
<p>Tham số <code>tenant</code> trong URL (fallback, dùng trong môi trường phát triển)</p>
</li>
<li>
<p>Dựa vào <code>tenant_id</code>, Gateway sẽ:</p>
</li>
<li>Forward request đến <strong>Sub Adapter / Sub Service</strong> đúng tenant.</li>
<li>Hoặc đến <strong>Tenant Master Service</strong> nếu request thuộc về Superadmin Webapp.</li>
</ul>
<h3 id="kiem-tra-rbac-ong-theo-tenant">🔐 Kiểm tra RBAC động theo tenant<a class="headerlink" href="#kiem-tra-rbac-ong-theo-tenant" title="Permanent link">¶</a></h3>
<ul>
<li>Gateway thực hiện xác thực JWT:</li>
<li>Do Auth Master hoặc Sub Auth Service phát hành.</li>
<li>
<p>Phải chứa: <code>user_id</code>, <code>tenant_id</code>, <code>roles</code>, <code>permissions</code>, <code>auth_provider</code>.</p>
</li>
<li>
<p>Kiểm tra trạng thái người dùng:</p>
</li>
<li><code>is_active</code> toàn cục (từ User Service Master)</li>
<li>
<p><code>is_active_in_tenant</code> (từ Sub User Service)</p>
</li>
<li>
<p>Truy vấn Redis cache để lấy <code>permissions</code> gắn theo <code>tenant_id</code>.</p>
</li>
<li>Evaluate <code>condition</code> (nếu có) theo context request (VD: <code>student_id</code>, <code>class_id</code>...)</li>
</ul>
<h3 id="forward-request">📦 Forward request<a class="headerlink" href="#forward-request" title="Permanent link">¶</a></h3>
<ul>
<li>Nếu pass: Gateway forward request đến backend service đúng tenant:</li>
<li>Gắn các header: <code>X-User-ID</code>, <code>X-Tenant-ID</code>, <code>X-Permissions</code>, <code>X-Role</code>, <code>X-Trace-ID</code>, <code>X-Auth-Method</code></li>
<li>Nếu fail: Trả lỗi 403 hoặc 401 tùy trường hợp.</li>
</ul>
<h3 id="bao-ve-noi-dung-inh-danh">🔐 Bảo vệ nội dung &amp; định danh<a class="headerlink" href="#bao-ve-noi-dung-inh-danh" title="Permanent link">¶</a></h3>
<ul>
<li>Các header định danh được ký (<code>X-Signature</code>) hoặc chỉ forward trong nội bộ (mTLS).</li>
<li>Backend service KHÔNG được chấp nhận header định danh nếu request từ bên ngoài Gateway.</li>
</ul>
<p>📘 Sơ đồ đánh giá RBAC xem chi tiết tại: 👉 <a href="architecture/system-diagrams/#4-rbac-evaluation-flow--luồng-đánh-giá-phân-quyền-động">RBAC Evaluation Flow – System Diagrams</a></p>
<h2 id="6-notification-service-multi-tenant-option-b">6. Notification Service (Multi-Tenant – Option B)<a class="headerlink" href="#6-notification-service-multi-tenant-option-b" title="Permanent link">¶</a></h2>
<p>Notification Service trong kiến trúc dx-vas được triển khai theo mô hình phân tầng, hỗ trợ gửi thông báo cách ly theo tenant và broadcast toàn hệ thống bằng kiến trúc bất đồng bộ qua Pub/Sub.</p>
<h3 id="phan-tang-dich-vu">🧭 Phân tầng dịch vụ<a class="headerlink" href="#phan-tang-dich-vu" title="Permanent link">¶</a></h3>
<h4 id="sub-notification-service-per-tenant">🔹 Sub Notification Service (per Tenant)<a class="headerlink" href="#sub-notification-service-per-tenant" title="Permanent link">¶</a></h4>
<ul>
<li>Mỗi tenant có một instance Notification Service riêng trong stack của mình.</li>
<li><strong>Chức năng:</strong></li>
<li>Gửi thông báo nội bộ của tenant (học phí, điểm danh, v.v.)</li>
<li>Quản lý template riêng (<code>notification_templates_in_tenant</code>)</li>
<li>Sử dụng cấu hình kênh riêng: Zalo OA, Gmail API, Google Chat webhook</li>
<li>Ghi log theo dõi gửi thông báo (<code>notification_logs_in_tenant</code>)</li>
<li><strong>Lắng nghe Pub/Sub:</strong> Subscribe vào topic <code>vas-global-notifications-topic</code>, lọc và xử lý các thông báo toàn hệ thống nếu phù hợp <code>tenant_id</code>.</li>
</ul>
<h4 id="notification-service-master-shared-core">🔹 Notification Service Master (Shared Core)<a class="headerlink" href="#notification-service-master-shared-core" title="Permanent link">¶</a></h4>
<ul>
<li>Phục vụ Superadmin Webapp.</li>
<li><strong>Chức năng:</strong></li>
<li>Gửi thông báo toàn hệ thống hoặc đến một nhóm trường.</li>
<li>Phát sự kiện <code>global_notification_requested</code> lên Pub/Sub với:<ul>
<li><code>target_tenant_ids</code> hoặc tiêu chí lọc (VD: <code>target_user_roles</code>)</li>
<li><code>message_id</code>, nội dung gốc, <code>correlation_id</code></li>
</ul>
</li>
<li>Không can thiệp chi tiết xử lý tại các tenant.</li>
<li>Thu thập trạng thái gửi từ các Sub Service thông qua sự kiện phản hồi <code>tenant_notification_batch_status</code>.</li>
</ul>
<hr/>
<h3 id="luong-gui-thong-bao-toan-he-thong-option-b-event-based">🔄 Luồng gửi thông báo toàn hệ thống (Option B – Event-based)<a class="headerlink" href="#luong-gui-thong-bao-toan-he-thong-option-b-event-based" title="Permanent link">¶</a></h3>
<ol>
<li>Superadmin gửi yêu cầu thông báo → Notification Service Master nhận.</li>
<li>Master publish sự kiện lên topic <code>vas-global-notifications-topic</code>.</li>
<li>Các Sub Notification Service subscribe topic:</li>
<li>Lọc theo <code>tenant_id</code>, xử lý nếu phù hợp.</li>
<li>Gửi thông báo bằng kênh riêng.</li>
<li>Gửi sự kiện phản hồi <code>tenant_notification_batch_status</code> lên topic <code>vas-tenant-notification-ack-topic</code>.</li>
</ol>
<hr/>
<h3 id="co-che-phong-ngua-rui-ro">✅ Cơ chế phòng ngừa rủi ro<a class="headerlink" href="#co-che-phong-ngua-rui-ro" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Rủi ro</th>
<th>Phòng ngừa</th>
</tr>
</thead>
<tbody>
<tr>
<td>Không theo dõi được trạng thái gửi</td>
<td>Sub gửi sự kiện phản hồi, Master hoặc một Monitor Service thu thập &amp; log</td>
</tr>
<tr>
<td>Gửi trùng thông báo (non-idempotent)</td>
<td>Dùng <code>message_id</code> duy nhất + kiểm tra <code>processed_global_notifications</code></td>
</tr>
<tr>
<td>Sub xử lý nhầm sự kiện không dành cho mình</td>
<td>Payload chứa rõ <code>target_tenant_ids</code>, Sub lọc kỹ</td>
</tr>
<tr>
<td>Sub quá tải khi nhận nhiều sự kiện</td>
<td>Giới hạn Pub/Sub <code>flow control</code> + xử lý bất đồng bộ nội bộ</td>
</tr>
<tr>
<td>Lỗi cấu hình kênh gửi</td>
<td>Sub log lỗi rõ, phát sự kiện phản hồi với trạng thái lỗi cụ thể</td>
</tr>
<tr>
<td>Dead Letter Topic bị đầy do lỗi lặp lại</td>
<td>Giám sát DLT, có quy trình re-publish sau fix logic</td>
</tr>
</tbody>
</table>
<hr/>
<p>📦 Các thành phần dữ liệu liên quan:</p>
<ul>
<li><code>notification_templates_in_tenant</code></li>
<li><code>channel_configs_in_tenant</code></li>
<li><code>notification_logs_in_tenant</code></li>
<li><code>global_notification_requested</code> (Pub/Sub)</li>
<li><code>tenant_notification_batch_status</code> (Pub/Sub ACK)</li>
<li><code>processed_global_notifications</code> (DB Sub)</li>
</ul>
<h2 id="7-superadmin-webapp-spa">7. Superadmin Webapp (SPA)<a class="headerlink" href="#7-superadmin-webapp-spa" title="Permanent link">¶</a></h2>
<p>Superadmin Webapp là ứng dụng quản trị tập trung dành riêng cho đội ngũ quản lý cấp công ty – nơi điều hành toàn bộ hệ thống dx-vas đa tenant.</p>
<h3 id="chuc-nang-chinh">🏛️ Chức năng chính<a class="headerlink" href="#chuc-nang-chinh" title="Permanent link">¶</a></h3>
<ul>
<li>Quản lý danh sách tenant (trường thành viên):</li>
<li>Tạo/sửa tenant mới, kích hoạt/khóa tenant</li>
<li>Cấu hình kết nối CRM/SIS/LMS cho từng tenant</li>
<li>Gán người dùng vào tenant:</li>
<li>Chọn user từ danh sách toàn cục</li>
<li>Chọn tenant và gán vai trò ban đầu</li>
<li>Gửi lời mời/OTP tới người dùng nếu cần</li>
<li>Quản lý role/permission toàn hệ thống:</li>
<li>Xây dựng <strong>Global Role/Permission Templates</strong></li>
<li>Xem các tenant đang dùng template nào</li>
<li>Clone/cập nhật/cảnh báo nếu tenant chỉnh sửa vượt chuẩn</li>
<li>Quản lý thông tin định danh người dùng:</li>
<li>Tìm kiếm user toàn hệ thống</li>
<li>Kiểm tra họ thuộc tenant nào, vai trò gì, trạng thái</li>
<li>Vô hiệu hóa tài khoản toàn cục hoặc theo từng tenant</li>
<li>Tổng hợp và theo dõi thống kê toàn hệ thống:</li>
<li>Số lượng học sinh/nhân sự theo từng tenant</li>
<li>Log hoạt động toàn hệ thống</li>
<li>Báo cáo phân quyền, truy cập, đăng nhập, chi phí (nếu cần)</li>
</ul>
<h3 id="cong-nghe-tich-hop">🛠 Công nghệ &amp; tích hợp<a class="headerlink" href="#cong-nghe-tich-hop" title="Permanent link">¶</a></h3>
<ul>
<li>SPA chạy trên domain riêng (<code>superadmin.truongvietanh.edu.vn</code>)</li>
<li>Đăng nhập qua Google OAuth2 (yêu cầu quyền <code>superadmin</code>)</li>
<li>Gọi API trực tiếp đến <strong>User Service Master</strong>, <strong>Auth Master</strong>, và các Tenant Registry Services</li>
<li>Kết nối đến các service quản lý chi phí, logging, audit tập trung</li>
</ul>
<p>📘 Các API được mô tả trong: <a href="./interfaces/ic-superadmin-webapp.md"><code>ic-superadmin-webapp.md</code></a></p>
<h2 id="8-ha-tang-trien-khai">8. Hạ tầng triển khai<a class="headerlink" href="#8-ha-tang-trien-khai" title="Permanent link">¶</a></h2>
<p>Hệ thống dx-vas được triển khai trên Google Cloud theo mô hình <strong>multi-tenant tách biệt theo stack</strong>, kết hợp với các thành phần dùng chung để tối ưu hoá bảo mật, khả năng mở rộng và quản trị tập trung.</p>
<h3 id="mo-hinh-trien-khai">🧱 Mô hình triển khai<a class="headerlink" href="#mo-hinh-trien-khai" title="Permanent link">¶</a></h3>
<h4 id="shared-core-dung-chung-toan-he-thong">📌 Shared Core (dùng chung toàn hệ thống)<a class="headerlink" href="#shared-core-dung-chung-toan-he-thong" title="Permanent link">¶</a></h4>
<ul>
<li><strong>API Gateway:</strong> Trung tâm điều phối request, xác thực, phân quyền động RBAC.</li>
<li><strong>Auth Service Master:</strong> Xử lý Google OAuth2, phát hành JWT đa tenant.</li>
<li><strong>User Service Master:</strong> Quản lý định danh người dùng toàn cục, tenant registry, RBAC templates.</li>
<li><strong>Superadmin Webapp:</strong> Quản trị toàn bộ hệ thống (tenant, người dùng, RBAC templates, báo cáo).</li>
<li><strong>Shared Redis Cluster:</strong> Cache RBAC theo <code>user_id + tenant_id</code> (theo namespace).</li>
<li><strong>Monitoring &amp; Audit Stack:</strong> Logging, tracing, SLO cho toàn bộ hệ thống.</li>
<li><strong>Pub/Sub Bus:</strong> Truyền sự kiện từ Master xuống các tenant stack.</li>
</ul>
<h4 id="tenant-stack-trien-khai-rieng-biet-cho-tung-truong-thanh-vien">🏫 Tenant Stack (triển khai riêng biệt cho từng trường thành viên)<a class="headerlink" href="#tenant-stack-trien-khai-rieng-biet-cho-tung-truong-thanh-vien" title="Permanent link">¶</a></h4>
<p>Mỗi tenant (trường) được triển khai dưới dạng <strong>một stack riêng biệt</strong> trên Google Cloud Run, bao gồm:</p>
<ul>
<li><strong>Frontend Apps riêng (PWA + Admin SPA)</strong>:</li>
<li>Chạy theo domain của từng trường: <code>abc.truongvietanh.edu.vn</code>, <code>xyz.truongvietanh.edu.vn</code></li>
<li><strong>Sub Auth Service</strong>:</li>
<li>Xác thực Local/OTP (phụ huynh, học sinh) độc lập theo tenant</li>
<li><strong>Sub User Service</strong>:</li>
<li>Quản lý RBAC riêng, mapping đến <code>user_id_global</code>, kiểm soát <code>is_active_in_tenant</code></li>
<li><strong>CRM/SIS/LMS Adapter riêng</strong>:</li>
<li>Kết nối đến hệ thống legacy của từng trường (SuiteCRM, Gibbon, Moodle)</li>
<li><strong>Database riêng hoặc schema phân vùng (nếu dùng chung Cloud SQL)</strong></li>
<li><strong>Logging riêng, giám sát riêng theo <code>tenant_id</code> và <code>env</code></strong></li>
</ul>
<h3 id="cau-truc-project-gcp-e-xuat">⚙️ Cấu trúc Project GCP đề xuất<a class="headerlink" href="#cau-truc-project-gcp-e-xuat" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Project</th>
<th>Mục đích</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dx-vas-core</code></td>
<td>Shared Core Services (API Gateway, Auth/User Master, PubSub, Redis...)</td>
</tr>
<tr>
<td><code>dx-vas-network</code></td>
<td>Shared VPC, NAT, DNS nội bộ</td>
</tr>
<tr>
<td><code>dx-vas-tenant-abc</code></td>
<td>Stack riêng cho tenant ABC</td>
</tr>
<tr>
<td><code>dx-vas-tenant-xyz</code></td>
<td>Stack riêng cho tenant XYZ</td>
</tr>
<tr>
<td><code>dx-vas-monitoring</code></td>
<td>Stack tập trung cho logging, metrics, alerting</td>
</tr>
<tr>
<td><code>dx-vas-data</code></td>
<td>Cloud SQL, GCS, BigQuery dùng chung hoặc phân vùng</td>
</tr>
</tbody>
</table>
<h3 id="cac-cong-nghe-ha-tang-su-dung">☁️ Các công nghệ hạ tầng sử dụng<a class="headerlink" href="#cac-cong-nghe-ha-tang-su-dung" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Cloud Run:</strong> Triển khai serverless cho tất cả services</li>
<li><strong>Cloud SQL:</strong> PostgreSQL (core), MySQL (adapter)</li>
<li><strong>Redis (MemoryStore):</strong> RBAC caching</li>
<li><strong>Cloud Pub/Sub:</strong> Đồng bộ định danh giữa master ↔ tenant</li>
<li><strong>Cloud Monitoring &amp; Logging:</strong> SLO/SLA tracking</li>
<li><strong>Terraform:</strong> Mô hình hoá hạ tầng theo module (<code>core</code>, <code>tenant</code>, <code>shared</code>)</li>
</ul>
<p>📘 Sơ đồ triển khai xem tại: 👉 <a href="architecture/system-diagrams/#9-deployment-overview-diagram--sơ-đồ-triển-khai-tổng-quan">Deployment Overview Diagram</a></p>
<h2 id="9-admin-webapp-spa-cap-o-tenant">9. Admin Webapp - SPA (cấp độ tenant)<a class="headerlink" href="#9-admin-webapp-spa-cap-o-tenant" title="Permanent link">¶</a></h2>
<p>Admin Webapp là ứng dụng quản trị nội bộ dành riêng cho từng trường thành viên (tenant). Đây là giao diện chính để giáo viên, nhân viên và ban giám hiệu quản lý hoạt động học tập, vận hành và phối hợp giữa các bộ phận trong trường.</p>
<h3 id="ac-iem">🧩 Đặc điểm<a class="headerlink" href="#ac-iem" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Triển khai độc lập cho từng tenant:</strong></li>
<li>Có domain riêng, ví dụ: <code>admin.abcschool.edu.vn</code>, <code>admin.xyzschool.edu.vn</code></li>
<li>
<p>Kết nối với các service backend riêng: CRM/SIS/LMS Adapter, Sub User Service, Sub Auth Service</p>
</li>
<li>
<p><strong>Đăng nhập:</strong></p>
</li>
<li>Nhân viên, giáo viên sử dụng Google OAuth2 (qua Auth Master)</li>
<li>Một số tenant có thể cho phép Local login (tùy cấu hình Sub Auth Service)</li>
</ul>
<h3 id="chuc-nang-chinh-theo-vai-tro">🛠 Chức năng chính theo vai trò<a class="headerlink" href="#chuc-nang-chinh-theo-vai-tro" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Giáo viên:</strong></li>
<li>Quản lý lớp giảng dạy, điểm danh, nhập điểm</li>
<li>Xem thời khóa biểu, nhận thông báo</li>
<li>
<p>Gửi phản hồi tới phụ huynh/học sinh</p>
</li>
<li>
<p><strong>Nhân viên học vụ / kế toán:</strong></p>
</li>
<li>Quản lý hồ sơ học sinh</li>
<li>Cập nhật học phí, tình trạng đóng tiền</li>
<li>
<p>Thống kê sĩ số, điểm số, báo cáo định kỳ</p>
</li>
<li>
<p><strong>Admin trường (BGH):</strong></p>
</li>
<li>Gán vai trò cho nhân sự trong tenant</li>
<li>Quản lý phân quyền nội bộ (RBAC tenant)</li>
<li>Kết nối CRM/SIS/LMS nếu được phép</li>
<li>Theo dõi nhật ký hoạt động của user trong trường</li>
</ul>
<h3 id="phan-quyen-bao-mat-noi-bo">🔒 Phân quyền &amp; bảo mật nội bộ<a class="headerlink" href="#phan-quyen-bao-mat-noi-bo" title="Permanent link">¶</a></h3>
<ul>
<li>Dựa trên RBAC từ <strong>Sub User Service</strong>, quyền được cấp theo vai trò trong từng tenant</li>
<li>Backend chỉ xử lý request có <code>X-Tenant-ID</code>, <code>X-User-ID</code> và <code>X-Permissions</code> do API Gateway cấp phát</li>
<li>Mọi thao tác quản trị được ghi log và trace theo <code>tenant_id</code> để phục vụ audit</li>
</ul>
<p>📘 Các API backend sử dụng được định nghĩa tại: <a href="services/user-service/interface-contract/"><code>user-service/interface-contract.md</code></a></p>
<h2 id="10-customer-portal-pwa-cap-o-tenant">10. Customer Portal - PWA (cấp độ tenant)<a class="headerlink" href="#10-customer-portal-pwa-cap-o-tenant" title="Permanent link">¶</a></h2>
<ul>
<li>Giao diện cho phụ huynh và học sinh.</li>
<li>Hỗ trợ OTP/Zalo login, cài đặt trên mobile, offline với cache gần nhất.</li>
<li>Chế độ offline chỉ cho phép đọc dữ liệu đã được cache trước đó.</li>
<li>Đồng bộ lại dữ liệu tự động khi có kết nối mạng.</li>
</ul>
<h2 id="11-crm-suitecrm-cap-o-tenant">11. CRM – SuiteCRM (cấp độ tenant)<a class="headerlink" href="#11-crm-suitecrm-cap-o-tenant" title="Permanent link">¶</a></h2>
<ul>
<li>Quản lý pipeline tuyển sinh.</li>
<li>Khi phụ huynh đăng ký nhập học thành công → tự chuyển sang SIS.</li>
<li>Giao tiếp qua API Gateway, kiểm soát RBAC.</li>
<li>Kế hoạch chuyển đổi cơ chế đồng bộ sang event-driven, dùng Pub/Sub hoặc Redis stream.</li>
</ul>
<h2 id="12-sis-gibbon-cap-o-tenant">12. SIS – Gibbon (cấp độ tenant)<a class="headerlink" href="#12-sis-gibbon-cap-o-tenant" title="Permanent link">¶</a></h2>
<ul>
<li>Quản lý học sinh, lớp, điểm danh, học phí.</li>
<li>Có export API cho LMS, Portal, Admin Webapp.</li>
<li>Lưu vết lịch sử: học lực, lớp học, học bạ.</li>
<li>Liên kết phụ huynh – học sinh lưu trong bảng tham chiếu.</li>
</ul>
<h2 id="13-lms-moodle-cap-o-tenant">13. LMS – Moodle (cấp độ tenant)<a class="headerlink" href="#13-lms-moodle-cap-o-tenant" title="Permanent link">¶</a></h2>
<ul>
<li>Học tập online, giao bài, chấm điểm.</li>
<li>SSO với OAuth2.</li>
<li>Tự động đồng bộ học sinh từ SIS.</li>
<li>Điểm có thể đẩy ngược về SIS.</li>
</ul>
<h2 id="14-notification-service">14. Notification Service<a class="headerlink" href="#14-notification-service" title="Permanent link">¶</a></h2>
<ul>
<li>Gửi thông báo Web, Email (Gmail API), Zalo OA, Google Chat.</li>
<li>Phụ huynh nhận thông báo qua Zalo/Email.</li>
<li>Học sinh, giáo viên nhận qua WebPush/Google Chat.</li>
<li>Người dùng chọn kênh ưa thích qua giao diện.</li>
<li>Tích hợp A/B testing và tracking nếu cần.</li>
</ul>
<h2 id="15-zalo-oa-google-chat">15. Zalo OA &amp; Google Chat<a class="headerlink" href="#15-zalo-oa-google-chat" title="Permanent link">¶</a></h2>
<ul>
<li>Gửi thông báo học phí, sự kiện qua Zalo ZNS.</li>
<li>Gửi nội bộ (giáo viên, nhân viên) qua Google Chat.</li>
<li>Có xử lý lỗi API, quota, timeout.</li>
<li>Dự kiến bổ sung cơ chế retry và dashboard kiểm tra trạng thái gửi.</li>
</ul>
<h2 id="16-cicd-devops">16. CI/CD &amp; DevOps<a class="headerlink" href="#16-cicd-devops" title="Permanent link">¶</a></h2>
<ul>
<li>GitHub Actions / Cloud Build → Cloud Run.</li>
<li>Staging + production, rollback.</li>
<li>Test tự động: unit, integration, End-to-End (E2E), và contract testing (Pact).</li>
<li>Đã áp dụng ADR-003 – secrets được quản lý và rotate định kỳ qua Secret Manager.</li>
<li>Dự kiến triển khai Chaos Testing cho các dịch vụ quan trọng.</li>
</ul>
<h2 id="17-bao-mat-giam-sat">17. Bảo mật &amp; Giám sát<a class="headerlink" href="#17-bao-mat-giam-sat" title="Permanent link">¶</a></h2>
<ul>
<li>Mã hóa dữ liệu nhạy cảm.</li>
<li>Chống OWASP Top 10, bao gồm CSRF, XSS, SQL Injection.</li>
<li>Triển khai xác thực đa yếu tố (MFA) cho các tài khoản quản trị và nhân viên quyền cao.</li>
<li>Giám sát xác thực phụ huynh (login rate, reset mật khẩu).</li>
<li>Ghi log chi tiết theo người dùng, endpoint, trạng thái.</li>
</ul>
<h2 id="18-data-migration-plan">18. Data Migration Plan<a class="headerlink" href="#18-data-migration-plan" title="Permanent link">¶</a></h2>
<ul>
<li>
<p>Nếu có hệ thống cũ, dữ liệu sẽ được di chuyển theo lộ trình Blueprint rõ ràng:</p>
</li>
<li>
<p>Mapping bảng dữ liệu</p>
</li>
<li>Kiểm tra chất lượng dữ liệu (data quality)</li>
<li>Kiểm thử trước và sau khi migrate</li>
<li>Rollback plan nếu phát hiện lỗi</li>
<li>Hỗ trợ chế độ song song (parallel run)</li>
</ul>
<h2 id="19-ao-tao-chuyen-giao">19. Đào tạo &amp; Chuyển giao<a class="headerlink" href="#19-ao-tao-chuyen-giao" title="Permanent link">¶</a></h2>
<ul>
<li>Mỗi nhóm người dùng sẽ có gói đào tạo riêng (nhân viên, giáo viên, học sinh, phụ huynh).</li>
<li>
<p>Tài liệu bao gồm:</p>
</li>
<li>
<p>Video ngắn</p>
</li>
<li>Handout dạng PDF</li>
<li>Demo trực tiếp (live/recorded)</li>
</ul>
<h2 id="20-tong-ket">20. Tổng kết<a class="headerlink" href="#20-tong-ket" title="Permanent link">¶</a></h2>
<p>Hệ thống chuyển đổi số VAS được thiết kế mở rộng linh hoạt đến 5260 người dùng, hỗ trợ xác thực phân tách giữa người dùng có Workspace (OAuth2) và phụ huynh (Local/OTP), đảm bảo bảo mật, giám sát, phục hồi thảm họa, đào tạo và khả năng phát triển dài hạn.</p>
<p>Toàn bộ các phản hồi chiến lược từ anh Bill đã được đưa vào kế hoạch hành động và roadmap triển khai – đặc biệt các khía cạnh RBAC UI, Data Sync, OTP Security, Offline PWA, DR Planning và Data Migration đã được chuẩn bị cụ thể và ghi nhận trong README.md này như một tài liệu trung tâm sống của dự án.</p>
<hr/>
<h2 id="phu-luc-a-danh-sach-quyet-inh-kien-truc-adrs">Phụ lục A – Danh sách Quyết định Kiến trúc (ADRs)<a class="headerlink" href="#phu-luc-a-danh-sach-quyet-inh-kien-truc-adrs" title="Permanent link">¶</a></h2>
<p>Dự án dx-vas sử dụng các Quyết định Kiến trúc (Architecture Decision Records - ADRs) để ghi lại những lựa chọn thiết kế quan trọng về mặt kiến trúc, bao gồm lý do, bối cảnh và các phương án đã được cân nhắc.</p>
<p>📘 Để xem danh sách đầy đủ và chi tiết các ADRs đã được phê duyệt, vui lòng truy cập: 👉 <a href="ADR/">Danh sách ADRs của dự án</a></p>
<hr/>
<h2 id="phu-luc-b-nguyen-tac-kien-truc-cot-loi">Phụ lục B – Nguyên tắc Kiến trúc Cốt lõi<a class="headerlink" href="#phu-luc-b-nguyen-tac-kien-truc-cot-loi" title="Permanent link">¶</a></h2>
<p>Hệ thống dx-vas được thiết kế theo các nguyên tắc nền tảng để đảm bảo mở rộng linh hoạt, bảo mật, tối ưu trải nghiệm người dùng và vận hành bền vững:</p>
<ul>
<li><strong>UX-first:</strong> Ưu tiên trải nghiệm người dùng (đặc biệt phụ huynh không rành công nghệ)</li>
<li><strong>Modular-first:</strong> Thiết kế hệ thống dạng microservice – dễ thay thế, triển khai riêng rẽ</li>
<li><strong>Security-by-Design:</strong> Tích hợp bảo mật từ đầu vào thiết kế (CSRF, RBAC, MFA, ký định danh)</li>
<li><strong>Data Consistency &gt; Availability:</strong> Trong môi trường giáo dục, dữ liệu đúng quan trọng hơn phản hồi nhanh</li>
<li><strong>Infra-as-Code:</strong> Hạ tầng và CI/CD đều được mô hình hóa, kiểm soát bằng mã nguồn</li>
</ul>
<h3 id="bo-sung-nguyen-tac-cho-multi-tenant">✨ Bổ sung nguyên tắc cho Multi-Tenant<a class="headerlink" href="#bo-sung-nguyen-tac-cho-multi-tenant" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Multi-Tenant by Isolation:</strong></li>
<li>Mỗi tenant có frontend, adapters, auth và user service riêng</li>
<li>Không chia sẻ database nếu không có cơ chế phân vùng/tenant ID rõ ràng</li>
<li>
<p>Cho phép mô hình tách stack theo tenant, đồng thời tận dụng tài nguyên shared core</p>
</li>
<li>
<p><strong>Centralized Identity &amp; Governance:</strong></p>
</li>
<li>Một User Service Master duy nhất là nơi kiểm soát định danh người dùng</li>
<li>Superadmin có toàn quyền điều phối, gán người dùng vào các tenant, quản lý templates RBAC</li>
<li>
<p>Mọi stack tenant phải tuân theo chuẩn JWT, RBAC schema và audit định danh</p>
</li>
<li>
<p><strong>Pluggable Tenant Stack:</strong></p>
</li>
<li>Mỗi tenant là một khối độc lập có thể được bật/tắt/destroy mà không ảnh hưởng hệ thống còn lại</li>
<li>
<p>Dễ dàng onboarding tenant mới bằng quy trình tự động hóa Terraform + CI/CD</p>
</li>
<li>
<p><strong>Auditability &amp; Traceability Across Tenants:</strong></p>
</li>
<li>Mọi action phân quyền, truy cập, login phải được log theo <code>tenant_id</code> + <code>user_id</code></li>
<li>Các thay đổi RBAC, kích hoạt/deactivate người dùng được trace toàn hệ thống</li>
</ul>
<p>📘 Các quyết định kiến trúc liên quan được mô tả trong:<br/>
- <a href="ADR/adr-007-rbac/">ADR-007: RBAC Strategy</a><br/>
- <a href="ADR/adr-006-auth-strategy/">ADR-006: Auth Strategy</a><br/>
- <a href="ADR/adr-019-project-layout/">ADR-019: GCP Project Layout</a><br/>
- <a href="ADR/adr-015-deployment-strategy/">ADR-015: Deployment Strategy</a></p>
<hr/>
<h2 id="phu-luc-c-so-o-kien-truc">Phụ lục C – Sơ đồ Kiến trúc<a class="headerlink" href="#phu-luc-c-so-o-kien-truc" title="Permanent link">¶</a></h2>
<p>📁 Các sơ đồ kiến trúc hệ thống được lưu trữ và cập nhật chi tiết tại: 👉 <a href="architecture/system-diagrams/">System Diagrams</a></p>
<p>Tài liệu này bao gồm:
- Sơ đồ tổng quan hệ thống
- Sơ đồ kiến trúc multi-tenant
- Các luồng nghiệp vụ chính (tuyển sinh, thông báo, phân quyền, xác thực…)
- Sơ đồ vòng đời tài khoản
- Sơ đồ triển khai hạ tầng trên Google Cloud
- Chú giải và hướng dẫn đọc sơ đồ</p>
<h3 id="so-o-tong-quan-kien-truc-multi-tenant">🧭 Sơ đồ tổng quan kiến trúc multi-tenant<a class="headerlink" href="#so-o-tong-quan-kien-truc-multi-tenant" title="Permanent link">¶</a></h3>
<pre class="mermaid"><code>flowchart TD
  subgraph Tenant_A["Tenant A Stack"]
    A_PWA[PWA A]
    A_Admin[Admin SPA A]
    A_Auth[Sub Auth A]
    A_User[Sub User A]
    A_CRM[CRM Adapter A]
    A_SIS[SIS Adapter A]
    A_LMS[LMS Adapter A]
  end

  subgraph Tenant_B["Tenant B Stack"]
    B_PWA[PWA B]
    B_Admin[Admin SPA B]
    B_Auth[Sub Auth B]
    B_User[Sub User B]
    B_CRM[CRM Adapter B]
    B_SIS[SIS Adapter B]
    B_LMS[LMS Adapter B]
  end

  subgraph Master["Shared Core Services"]
    Gateway[API Gateway]
    AuthMaster[Auth Service Master]
    UserMaster[User Service Master]
    Superadmin[Superadmin Webapp]
    Redis[Redis Cache]
    PubSub[Pub/Sub]
    Logging[Monitoring &amp; Audit]
  end

  A_PWA --&gt; Gateway
  A_Admin --&gt; Gateway
  B_PWA --&gt; Gateway
  B_Admin --&gt; Gateway

  Gateway --&gt; AuthMaster
  Gateway --&gt; UserMaster
  Gateway --&gt; Redis
  Gateway --&gt; Logging

  Gateway --&gt; A_Auth
  Gateway --&gt; A_User
  Gateway --&gt; A_CRM
  Gateway --&gt; A_SIS
  Gateway --&gt; A_LMS

  Gateway --&gt; B_Auth
  Gateway --&gt; B_User
  Gateway --&gt; B_CRM
  Gateway --&gt; B_SIS
  Gateway --&gt; B_LMS

  AuthMaster --&gt; UserMaster
  A_Auth --&gt; UserMaster
  B_Auth --&gt; UserMaster

  Superadmin --&gt; UserMaster
</code></pre>
<p>📌 <strong>Ý nghĩa sơ đồ</strong>:</p>
<ul>
<li><strong>Gateway</strong> là trung tâm điều phối, phân quyền và định tuyến theo <code>tenant_id</code>.</li>
<li>Mỗi tenant có <strong>stack riêng biệt hoàn toàn</strong>, độc lập về frontend, adapters và phân quyền nội bộ.</li>
<li>Các khối <strong>Master</strong> là dịch vụ dùng chung, duy trì tập trung danh tính, phân quyền mẫu và điều phối toàn hệ thống.</li>
<li>Superadmin Webapp tương tác trực tiếp với các dịch vụ Master để điều hành toàn bộ kiến trúc.</li>
</ul>
<p>📘 Để xem đầy đủ các sơ đồ chi tiết hơn (RBAC, Auth, Lifecycle, Sync...), truy cập: <a href="architecture/system-diagrams/">system-diagrams.md</a></p>
<hr/>
<h2 id="phu-luc-d-interface-contracts-ics">Phụ lục D – Interface Contracts (ICs)<a class="headerlink" href="#phu-luc-d-interface-contracts-ics" title="Permanent link">¶</a></h2>
<p>Tất cả các dịch vụ trong hệ thống dx-vas đều có tài liệu định nghĩa giao tiếp (Interface Contracts), sử dụng định dạng Markdown mô tả OpenAPI hoặc UI behavior.</p>
<p>📁 Các tài liệu IC được lưu trữ tại thư mục: <a href="./interfaces/"><code>interfaces</code></a></p>
<table>
<thead>
<tr>
<th>Dịch vụ</th>
<th>Mô tả</th>
<th>File IC</th>
</tr>
</thead>
<tbody>
<tr>
<td>API Gateway</td>
<td>Cổng vào trung tâm của hệ thống, xử lý xác thực và kiểm tra RBAC</td>
<td><a href="interfaces/ic-01-api-gateway/"><code>ic-01-api-gateway.md</code></a></td>
</tr>
<tr>
<td>Admin Webapp</td>
<td>Ứng dụng quản trị nội bộ cho nhân viên và giáo viên</td>
<td><a href="interfaces/ic-02-admin-webapp/"><code>ic-02-admin-webapp.md</code></a></td>
</tr>
<tr>
<td>Customer Portal</td>
<td>PWA dành cho phụ huynh và học sinh</td>
<td><a href="interfaces/ic-03-customer-portal/"><code>ic-03-customer-portal.md</code></a></td>
</tr>
<tr>
<td>Notification Service</td>
<td>Dịch vụ gửi thông báo đa kênh (Web, Email, Zalo, Chat)</td>
<td><a href="interfaces/ic-04-notification/"><code>ic-04-notification.md</code></a></td>
</tr>
<tr>
<td>CRM Adapter</td>
<td>Giao tiếp với SuiteCRM trong quá trình tuyển sinh</td>
<td><a href="interfaces/ic-05-crm/"><code>ic-05-crm.md</code></a></td>
</tr>
<tr>
<td>SIS Adapter</td>
<td>Giao tiếp với hệ thống Gibbon SIS</td>
<td><a href="interfaces/ic-06-sis/"><code>ic-06-sis.md</code></a></td>
</tr>
<tr>
<td>LMS Adapter</td>
<td>Giao tiếp với hệ thống Moodle LMS</td>
<td><a href="interfaces/ic-07-lms/"><code>ic-07-lms.md</code></a></td>
</tr>
<tr>
<td>Auth Service</td>
<td>Dịch vụ xác thực và phát hành token (OAuth2, OTP)</td>
<td><a href="interfaces/ic-08-auth-service/"><code>ic-08-auth-service.md</code></a></td>
</tr>
<tr>
<td>User Service</td>
<td>Quản lý người dùng, phân quyền động RBAC, trạng thái hoạt động</td>
<td><a href="interfaces/ic-09-user-service/"><code>ic-09-user-service.md</code></a></td>
</tr>
</tbody>
</table>
<p>📌 Mỗi IC có thể bao gồm:
- Mô tả các API endpoint hoặc UI behavior chính
- Các schema (request/response)
- Quy tắc RBAC áp dụng nếu có
- Link tham chiếu đến các ADR hoặc schema dùng chung</p>
<hr/>
<h2 id="phu-luc-e-huong-dan-ong-gop-phat-trien">Phụ lục E – Hướng dẫn đóng góp &amp; phát triển<a class="headerlink" href="#phu-luc-e-huong-dan-ong-gop-phat-trien" title="Permanent link">¶</a></h2>
<ul>
<li>Quy trình pull request &amp; review code tại: <code>CONTRIBUTING.md</code></li>
<li>Coding style: theo PEP8 + Black (Python), ESLint (JS)</li>
<li>Test coverage yêu cầu: ≥ 85% unit, ≥ 70% integration</li>
<li>
<p>Luồng CI/CD:</p>
</li>
<li>
<p>Push code → CI chạy lint/test/scan</p>
</li>
<li>Merge vào <code>dev</code> → Deploy Staging</li>
<li>Merge vào <code>main</code> → Require approval → Deploy Production</li>
</ul>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Trở lại mục lục
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.annotate", "content.tabs.link"], "search": "assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u0110\u00e3 sao ch\u00e9p", "clipboard.copy": "Sao ch\u00e9p v\u00e0o b\u1ed9 nh\u1edb t\u1ea1m", "search.result.more.one": "1 t\u1eeb kh\u00e1c trong trang", "search.result.more.other": "# t\u1eeb kh\u00e1c trong trang", "search.result.none": "Kh\u00f4ng t\u00ecm th\u1ea5y t\u00e0i li\u1ec7u li\u00ean quan", "search.result.one": "1 t\u00e0i li\u1ec7u li\u00ean quan", "search.result.other": "# t\u00e0i li\u1ec7u li\u00ean quan", "search.result.placeholder": "Nh\u1eadp \u0111\u1ec3 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm", "search.result.term.missing": "Kh\u00f4ng", "select.version": "Ch\u1ecdn phi\u00ean b\u1ea3n"}, "version": null}</script>
<script src="assets/javascripts/bundle.13a4f30d.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body>
</html>