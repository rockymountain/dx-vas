
<!DOCTYPE html>

<html class="no-js" lang="vi">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="TÃ i liá»‡u kiáº¿n trÃºc vÃ  phÃ¡t triá»ƒn cho dá»± Ã¡n Chuyá»ƒn Ä‘á»•i sá»‘ TrÆ°á»ng Viá»‡t Anh (dx_vas)." name="description"/>
<meta content="DX VAS Team" name="author"/>
<link href="https://dx.truongvietanh.edu.vn/dev/ops-guide/" rel="canonical"/>
<link href="../backend-dev-guide/" rel="prev"/>
<link href="../../services/user-service/design/" rel="next"/>
<link href="../../assets/images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.14" name="generator"/>
<title>Váº­n hÃ nh &amp; DevOps (Ops Guide) - DX VAS - Docs</title>
<link href="../../assets/stylesheets/main.342714a4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="pink" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ops-guide-dx-vas">
          Bá» qua
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Äáº§u trang" class="md-header__inner md-grid">
<a aria-label="DX VAS - Docs" class="md-header__button md-logo" data-md-component="logo" href="../.." title="DX VAS - Docs">
<img alt="logo" src="../../assets/images/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            DX VAS - Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Váº­n hÃ nh &amp; DevOps (Ops Guide)
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="pink" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="lime" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="blue" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="TÃ¬m kiáº¿m" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="TÃ¬m kiáº¿m" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="TÃ¬m kiáº¿m" class="md-search__options">
<button aria-label="XoÃ¡" class="md-search__icon md-icon" tabindex="-1" title="XoÃ¡" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/rockymountain/dx-vas.git" title="Xem mÃ£ nguá»“n">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    rockymountain/dx-vas
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
          
  
  
    
  
  Kiáº¿n trÃºc Há»‡ thá»‘ng

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../dev-guide/">
          
  
  
    
  
  HÆ°á»›ng dáº«n PhÃ¡t triá»ƒn

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../services/user-service/design/">
          
  
  
    
  
  Thiáº¿t káº¿ Services

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../ADR/">
          
  
  
    
  
  Quyáº¿t Ä‘á»‹nh Kiáº¿n trÃºc (ADRs)

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Thanh Ä‘iá»u hÆ°á»›ng" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="DX VAS - Docs" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="DX VAS - Docs">
<img alt="logo" src="../../assets/images/logo.png"/>
</a>
    DX VAS - Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/rockymountain/dx-vas.git" title="Xem mÃ£ nguá»“n">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    rockymountain/dx-vas
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Kiáº¿n trÃºc Há»‡ thá»‘ng
    
  </span>
</a>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Kiáº¿n trÃºc Há»‡ thá»‘ng
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/system-diagrams/">
<span class="md-ellipsis">
    SÆ¡ Ä‘á»“ Há»‡ thá»‘ng
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/rbac-deep-dive/">
<span class="md-ellipsis">
    RBAC Chi tiáº¿t
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
<span class="md-ellipsis">
    HÆ°á»›ng dáº«n PhÃ¡t triá»ƒn
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            HÆ°á»›ng dáº«n PhÃ¡t triá»ƒn
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../dev-guide/">
<span class="md-ellipsis">
    Tá»•ng quan PhÃ¡t triá»ƒn (Dev Guide)
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../backend-dev-guide/">
<span class="md-ellipsis">
    Backend Dev Guide
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Váº­n hÃ nh &amp; DevOps (Ops Guide)
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Váº­n hÃ nh &amp; DevOps (Ops Guide)
    
  </span>
</a>
<nav aria-label="Má»¥c lá»¥c" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Má»¥c lá»¥c
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#muc-luc">
<span class="md-ellipsis">
      Má»¥c lá»¥c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1-tong-quan-trien-khai-ha-tang">
<span class="md-ellipsis">
      1. Tá»•ng quan triá»ƒn khai háº¡ táº§ng
    </span>
</a>
<nav aria-label="1. Tá»•ng quan triá»ƒn khai háº¡ táº§ng" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#kien-truc-trien-khai-chinh">
<span class="md-ellipsis">
      âš™ï¸ Kiáº¿n trÃºc triá»ƒn khai chÃ­nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ha-tang-phan-tang">
<span class="md-ellipsis">
      â˜ï¸ Háº¡ táº§ng phÃ¢n táº§ng
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#moi-truong-trien-khai">
<span class="md-ellipsis">
      ğŸ—‚ï¸ MÃ´i trÆ°á»ng triá»ƒn khai
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-trien-khai-dich-vu-moi-truong">
<span class="md-ellipsis">
      2. Triá»ƒn khai dá»‹ch vá»¥ &amp; mÃ´i trÆ°á»ng
    </span>
</a>
<nav aria-label="2. Triá»ƒn khai dá»‹ch vá»¥ &amp; mÃ´i trÆ°á»ng" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mo-hinh-multi-repo">
<span class="md-ellipsis">
      ğŸ“¦ MÃ´ hÃ¬nh multi-repo
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quy-trinh-trien-khai-ien-hinh">
<span class="md-ellipsis">
      ğŸ§± Quy trÃ¬nh triá»ƒn khai Ä‘iá»ƒn hÃ¬nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cau-hinh-deploy-vi-du-github-actions">
<span class="md-ellipsis">
      ğŸ›  Cáº¥u hÃ¬nh deploy (vÃ­ dá»¥ GitHub Actions)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cau-hinh-bien-moi-truong-cloud-run">
<span class="md-ellipsis">
      ğŸ“ Cáº¥u hÃ¬nh biáº¿n mÃ´i trÆ°á»ng (Cloud Run)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-giam-sat-canh-bao">
<span class="md-ellipsis">
      3. GiÃ¡m sÃ¡t &amp; cáº£nh bÃ¡o
    </span>
</a>
<nav aria-label="3. GiÃ¡m sÃ¡t &amp; cáº£nh bÃ¡o" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-loai-metric-giam-sat">
<span class="md-ellipsis">
      ğŸ“Š CÃ¡c loáº¡i metric giÃ¡m sÃ¡t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#alerting-rule-goi-y">
<span class="md-ellipsis">
      âš ï¸ Alerting rule gá»£i Ã½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dashboard-e-xuat">
<span class="md-ellipsis">
      ğŸ“‰ Dashboard Ä‘á» xuáº¥t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#canh-bao-thong-bao">
<span class="md-ellipsis">
      ğŸ”„ Cáº£nh bÃ¡o &amp; thÃ´ng bÃ¡o
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#so-o-luong-canh-bao-monitoring-alerts">
<span class="md-ellipsis">
      ğŸ›ï¸ SÆ¡ Ä‘á»“ luá»“ng cáº£nh bÃ¡o (Monitoring Alerts)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-logging-trace-phan-tan">
<span class="md-ellipsis">
      4. Logging &amp; Trace phÃ¢n tÃ¡n
    </span>
</a>
<nav aria-label="4. Logging &amp; Trace phÃ¢n tÃ¡n" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#inh-dang-log-chuan">
<span class="md-ellipsis">
      ğŸ§¾ Äá»‹nh dáº¡ng log chuáº©n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trace-phan-tan">
<span class="md-ellipsis">
      ğŸ” Trace phÃ¢n tÃ¡n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#su-dung-log-trace">
<span class="md-ellipsis">
      ğŸ“Š Sá»­ dá»¥ng log &amp; trace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#goi-y-log-prefix">
<span class="md-ellipsis">
      ğŸ—‚ï¸ Gá»£i Ã½ log prefix
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-bao-mat">
<span class="md-ellipsis">
      ğŸ” Log báº£o máº­t
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-quan-ly-bao-mat-credentials">
<span class="md-ellipsis">
      5. Quáº£n lÃ½ báº£o máº­t &amp; credentials
    </span>
</a>
<nav aria-label="5. Quáº£n lÃ½ báº£o máº­t &amp; credentials" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#loai-thong-tin-can-bao-ve">
<span class="md-ellipsis">
      ğŸ” Loáº¡i thÃ´ng tin cáº§n báº£o vá»‡
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quan-ly-cau-hinh-ong-khong-nhay-cam">
<span class="md-ellipsis">
      ğŸ§© Quáº£n lÃ½ cáº¥u hÃ¬nh Ä‘á»™ng (khÃ´ng nháº¡y cáº£m)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quy-trinh-quan-ly-secret">
<span class="md-ellipsis">
      ğŸ§± Quy trÃ¬nh quáº£n lÃ½ secret
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thuc-hanh-tot">
<span class="md-ellipsis">
      ğŸ“¦ Thá»±c hÃ nh tá»‘t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-tra-nhanh">
<span class="md-ellipsis">
      ğŸ§ª Kiá»ƒm tra nhanh
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-chien-luoc-scaling-autoscale">
<span class="md-ellipsis">
      6. Chiáº¿n lÆ°á»£c scaling &amp; autoscale
    </span>
</a>
<nav aria-label="6. Chiáº¿n lÆ°á»£c scaling &amp; autoscale" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#autoscaling-mac-inh">
<span class="md-ellipsis">
      âš™ï¸ Autoscaling máº·c Ä‘á»‹nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hanh-vi-scaling">
<span class="md-ellipsis">
      ğŸ” HÃ nh vi scaling
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#toi-uu-scaling">
<span class="md-ellipsis">
      ğŸ“‰ Tá»‘i Æ°u scaling
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y_1">
<span class="md-ellipsis">
      ğŸ” LÆ°u Ã½
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-quy-trinh-cap-nhat-rollback">
<span class="md-ellipsis">
      7. Quy trÃ¬nh cáº­p nháº­t &amp; rollback
    </span>
</a>
<nav aria-label="7. Quy trÃ¬nh cáº­p nháº­t &amp; rollback" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#quy-trinh-cap-nhat">
<span class="md-ellipsis">
      ğŸš€ Quy trÃ¬nh cáº­p nháº­t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-soat-theo-moi-truong">
<span class="md-ellipsis">
      ğŸ“¦ Kiá»ƒm soÃ¡t theo mÃ´i trÆ°á»ng
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rollback-khi-loi">
<span class="md-ellipsis">
      ğŸ›‘ Rollback khi lá»—i
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y-khi-kiem-tra-version">
<span class="md-ellipsis">
      ğŸ§ª LÆ°u Ã½ khi kiá»ƒm tra version
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nhung-rui-ro-can-chu-y">
<span class="md-ellipsis">
      âš ï¸ Nhá»¯ng rá»§i ro cáº§n chÃº Ã½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#zero-downtime-deployment-canary-release-cloud-run">
<span class="md-ellipsis">
      âœ¨ Zero Downtime Deployment &amp; Canary Release (Cloud Run)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-quan-ly-pubsub-dead-letter">
<span class="md-ellipsis">
      8. Quáº£n lÃ½ Pub/Sub &amp; Dead Letter
    </span>
</a>
<nav aria-label="8. Quáº£n lÃ½ Pub/Sub &amp; Dead Letter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-topic-chinh">
<span class="md-ellipsis">
      ğŸ” CÃ¡c topic chÃ­nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dead-letter-topics-dlt">
<span class="md-ellipsis">
      ğŸ“¦ Dead Letter Topics (DLT)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#giam-sat-pubsub">
<span class="md-ellipsis">
      ğŸ” GiÃ¡m sÃ¡t Pub/Sub
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#handling-retry">
<span class="md-ellipsis">
      ğŸ›  Handling retry
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#debug-dlt-message">
<span class="md-ellipsis">
      âœï¸ Debug DLT message
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-kiem-soat-chi-phi-toi-uu-tai-nguyen">
<span class="md-ellipsis">
      9. Kiá»ƒm soÃ¡t chi phÃ­ &amp; tá»‘i Æ°u tÃ i nguyÃªn
    </span>
</a>
<nav aria-label="9. Kiá»ƒm soÃ¡t chi phÃ­ &amp; tá»‘i Æ°u tÃ i nguyÃªn" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-thanh-phan-ton-chi-phi">
<span class="md-ellipsis">
      ğŸ’° CÃ¡c thÃ nh pháº§n tá»‘n chi phÃ­
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#network-egress-costs">
<span class="md-ellipsis">
      ğŸŒ Network Egress Costs
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#theo-doi-chi-phi">
<span class="md-ellipsis">
      ğŸ“Š Theo dÃµi chi phÃ­
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chien-luoc-toi-uu">
<span class="md-ellipsis">
      ğŸ¯ Chiáº¿n lÆ°á»£c tá»‘i Æ°u
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#canh-bao-thuc-te">
<span class="md-ellipsis">
      âš ï¸ Cáº£nh bÃ¡o thá»±c táº¿
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-checklist-inh-ky-van-hanh">
<span class="md-ellipsis">
      10. Checklist Ä‘á»‹nh ká»³ váº­n hÃ nh
    </span>
</a>
<nav aria-label="10. Checklist Ä‘á»‹nh ká»³ váº­n hÃ nh" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#hang-tuan">
<span class="md-ellipsis">
      ğŸ” HÃ ng tuáº§n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hang-thang">
<span class="md-ellipsis">
      ğŸ“… HÃ ng thÃ¡ng
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hang-quy">
<span class="md-ellipsis">
      ğŸ“£ HÃ ng quÃ½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cach-theo-doi-checklist">
<span class="md-ellipsis">
      ğŸ“Œ CÃ¡ch theo dÃµi checklist
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#11-ung-pho-su-co-khoi-phuc">
<span class="md-ellipsis">
      11. á»¨ng phÃ³ sá»± cá»‘ &amp; khÃ´i phá»¥c
    </span>
</a>
<nav aria-label="11. á»¨ng phÃ³ sá»± cá»‘ &amp; khÃ´i phá»¥c" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#vai-tro-trong-quy-trinh-ung-pho-su-co-incident-response-roles">
<span class="md-ellipsis">
      ğŸ§‘â€ğŸš’ Vai trÃ² trong quy trÃ¬nh á»©ng phÃ³ sá»± cá»‘ (Incident Response Roles)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phan-loai-su-co">
<span class="md-ellipsis">
      ğŸš¨ PhÃ¢n loáº¡i sá»± cá»‘
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#checklist-phan-ung-nhanh">
<span class="md-ellipsis">
      ğŸ§¯ Checklist pháº£n á»©ng nhanh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-cong-cu-ho-tro">
<span class="md-ellipsis">
      ğŸ—‚ Log &amp; cÃ´ng cá»¥ há»— trá»£
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#postmortem-template">
<span class="md-ellipsis">
      ğŸ“‹ Postmortem template
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12-backup-disaster-recovery-dr">
<span class="md-ellipsis">
      12. Backup &amp; Disaster Recovery (DR)
    </span>
</a>
<nav aria-label="12. Backup &amp; Disaster Recovery (DR)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#rto-rpo-muc-tieu">
<span class="md-ellipsis">
      ğŸ¯ RTO &amp; RPO má»¥c tiÃªu
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backup-chien-luoc">
<span class="md-ellipsis">
      ğŸ“¦ Backup chiáº¿n lÆ°á»£c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-thu-dr-inh-ky">
<span class="md-ellipsis">
      ğŸ” Kiá»ƒm thá»­ DR Ä‘á»‹nh ká»³
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y-bao-mat">
<span class="md-ellipsis">
      ğŸ” LÆ°u Ã½ báº£o máº­t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cong-cu-kiem-tra-khoi-phuc">
<span class="md-ellipsis">
      ğŸ§ª CÃ´ng cá»¥ kiá»ƒm tra &amp; khÃ´i phá»¥c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#vi-du-kich-ban-dr-mat-ket-noi-cloud-sql">
<span class="md-ellipsis">
      ğŸ§ª VÃ­ dá»¥: Ká»‹ch báº£n DR â€“ Máº¥t káº¿t ná»‘i Cloud SQL
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#13-security-audit-compliance">
<span class="md-ellipsis">
      13. Security audit &amp; compliance
    </span>
</a>
<nav aria-label="13. Security audit &amp; compliance" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-tra-inh-ky">
<span class="md-ellipsis">
      ğŸ” Kiá»ƒm tra Ä‘á»‹nh ká»³
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lich-audit-goi-y">
<span class="md-ellipsis">
      ğŸ“… Lá»‹ch audit gá»£i Ã½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cong-cu-ho-tro-audit">
<span class="md-ellipsis">
      ğŸ›  CÃ´ng cá»¥ há»— trá»£ audit
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#compliance-noi-bo">
<span class="md-ellipsis">
      ğŸ”’ Compliance (ná»™i bá»™)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#14-cong-cu-dashboard-ho-tro">
<span class="md-ellipsis">
      14. CÃ´ng cá»¥ &amp; dashboard há»— trá»£
    </span>
</a>
<nav aria-label="14. CÃ´ng cá»¥ &amp; dashboard há»— trá»£" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#bo-cong-cu-chinh">
<span class="md-ellipsis">
      ğŸ§° Bá»™ cÃ´ng cá»¥ chÃ­nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dashboard-tham-khao">
<span class="md-ellipsis">
      ğŸ“Š Dashboard tham kháº£o
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bang-lenh-cli-devops-thuong-dung-gcp-cloud-run-pubsub-cloud-sql">
<span class="md-ellipsis">
      ğŸ§° Báº£ng lá»‡nh CLI DevOps thÆ°á»ng dÃ¹ng (GCP â€“ Cloud Run, Pub/Sub, Cloud SQL)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#uong-dan-huu-ich">
<span class="md-ellipsis">
      ğŸ“ ÄÆ°á»ng dáº«n há»¯u Ã­ch
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Thiáº¿t káº¿ Services
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Thiáº¿t káº¿ Services
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
<span class="md-ellipsis">
    User Service
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
            User Service
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/user-service/design/">
<span class="md-ellipsis">
    Tá»•ng quan Thiáº¿t káº¿
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/user-service/interface-contract/">
<span class="md-ellipsis">
    Há»£p Ä‘á»“ng Giao diá»‡n
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/user-service/data-model/">
<span class="md-ellipsis">
    MÃ´ hÃ¬nh Dá»¯ liá»‡u
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../services/user-service/openapi.yaml">
<span class="md-ellipsis">
    Äáº·c táº£ OpenAPI
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../ADR/">
<span class="md-ellipsis">
    Quyáº¿t Ä‘á»‹nh Kiáº¿n trÃºc (ADRs)
    
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Quyáº¿t Ä‘á»‹nh Kiáº¿n trÃºc (ADRs)
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Má»¥c lá»¥c" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Má»¥c lá»¥c
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#muc-luc">
<span class="md-ellipsis">
      Má»¥c lá»¥c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1-tong-quan-trien-khai-ha-tang">
<span class="md-ellipsis">
      1. Tá»•ng quan triá»ƒn khai háº¡ táº§ng
    </span>
</a>
<nav aria-label="1. Tá»•ng quan triá»ƒn khai háº¡ táº§ng" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#kien-truc-trien-khai-chinh">
<span class="md-ellipsis">
      âš™ï¸ Kiáº¿n trÃºc triá»ƒn khai chÃ­nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ha-tang-phan-tang">
<span class="md-ellipsis">
      â˜ï¸ Háº¡ táº§ng phÃ¢n táº§ng
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#moi-truong-trien-khai">
<span class="md-ellipsis">
      ğŸ—‚ï¸ MÃ´i trÆ°á»ng triá»ƒn khai
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-trien-khai-dich-vu-moi-truong">
<span class="md-ellipsis">
      2. Triá»ƒn khai dá»‹ch vá»¥ &amp; mÃ´i trÆ°á»ng
    </span>
</a>
<nav aria-label="2. Triá»ƒn khai dá»‹ch vá»¥ &amp; mÃ´i trÆ°á»ng" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#mo-hinh-multi-repo">
<span class="md-ellipsis">
      ğŸ“¦ MÃ´ hÃ¬nh multi-repo
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quy-trinh-trien-khai-ien-hinh">
<span class="md-ellipsis">
      ğŸ§± Quy trÃ¬nh triá»ƒn khai Ä‘iá»ƒn hÃ¬nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cau-hinh-deploy-vi-du-github-actions">
<span class="md-ellipsis">
      ğŸ›  Cáº¥u hÃ¬nh deploy (vÃ­ dá»¥ GitHub Actions)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cau-hinh-bien-moi-truong-cloud-run">
<span class="md-ellipsis">
      ğŸ“ Cáº¥u hÃ¬nh biáº¿n mÃ´i trÆ°á»ng (Cloud Run)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-giam-sat-canh-bao">
<span class="md-ellipsis">
      3. GiÃ¡m sÃ¡t &amp; cáº£nh bÃ¡o
    </span>
</a>
<nav aria-label="3. GiÃ¡m sÃ¡t &amp; cáº£nh bÃ¡o" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-loai-metric-giam-sat">
<span class="md-ellipsis">
      ğŸ“Š CÃ¡c loáº¡i metric giÃ¡m sÃ¡t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#alerting-rule-goi-y">
<span class="md-ellipsis">
      âš ï¸ Alerting rule gá»£i Ã½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dashboard-e-xuat">
<span class="md-ellipsis">
      ğŸ“‰ Dashboard Ä‘á» xuáº¥t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#canh-bao-thong-bao">
<span class="md-ellipsis">
      ğŸ”„ Cáº£nh bÃ¡o &amp; thÃ´ng bÃ¡o
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#so-o-luong-canh-bao-monitoring-alerts">
<span class="md-ellipsis">
      ğŸ›ï¸ SÆ¡ Ä‘á»“ luá»“ng cáº£nh bÃ¡o (Monitoring Alerts)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-logging-trace-phan-tan">
<span class="md-ellipsis">
      4. Logging &amp; Trace phÃ¢n tÃ¡n
    </span>
</a>
<nav aria-label="4. Logging &amp; Trace phÃ¢n tÃ¡n" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#inh-dang-log-chuan">
<span class="md-ellipsis">
      ğŸ§¾ Äá»‹nh dáº¡ng log chuáº©n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trace-phan-tan">
<span class="md-ellipsis">
      ğŸ” Trace phÃ¢n tÃ¡n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#su-dung-log-trace">
<span class="md-ellipsis">
      ğŸ“Š Sá»­ dá»¥ng log &amp; trace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#goi-y-log-prefix">
<span class="md-ellipsis">
      ğŸ—‚ï¸ Gá»£i Ã½ log prefix
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-bao-mat">
<span class="md-ellipsis">
      ğŸ” Log báº£o máº­t
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-quan-ly-bao-mat-credentials">
<span class="md-ellipsis">
      5. Quáº£n lÃ½ báº£o máº­t &amp; credentials
    </span>
</a>
<nav aria-label="5. Quáº£n lÃ½ báº£o máº­t &amp; credentials" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#loai-thong-tin-can-bao-ve">
<span class="md-ellipsis">
      ğŸ” Loáº¡i thÃ´ng tin cáº§n báº£o vá»‡
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quan-ly-cau-hinh-ong-khong-nhay-cam">
<span class="md-ellipsis">
      ğŸ§© Quáº£n lÃ½ cáº¥u hÃ¬nh Ä‘á»™ng (khÃ´ng nháº¡y cáº£m)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quy-trinh-quan-ly-secret">
<span class="md-ellipsis">
      ğŸ§± Quy trÃ¬nh quáº£n lÃ½ secret
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#thuc-hanh-tot">
<span class="md-ellipsis">
      ğŸ“¦ Thá»±c hÃ nh tá»‘t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-tra-nhanh">
<span class="md-ellipsis">
      ğŸ§ª Kiá»ƒm tra nhanh
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-chien-luoc-scaling-autoscale">
<span class="md-ellipsis">
      6. Chiáº¿n lÆ°á»£c scaling &amp; autoscale
    </span>
</a>
<nav aria-label="6. Chiáº¿n lÆ°á»£c scaling &amp; autoscale" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#autoscaling-mac-inh">
<span class="md-ellipsis">
      âš™ï¸ Autoscaling máº·c Ä‘á»‹nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hanh-vi-scaling">
<span class="md-ellipsis">
      ğŸ” HÃ nh vi scaling
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#toi-uu-scaling">
<span class="md-ellipsis">
      ğŸ“‰ Tá»‘i Æ°u scaling
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y_1">
<span class="md-ellipsis">
      ğŸ” LÆ°u Ã½
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-quy-trinh-cap-nhat-rollback">
<span class="md-ellipsis">
      7. Quy trÃ¬nh cáº­p nháº­t &amp; rollback
    </span>
</a>
<nav aria-label="7. Quy trÃ¬nh cáº­p nháº­t &amp; rollback" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#quy-trinh-cap-nhat">
<span class="md-ellipsis">
      ğŸš€ Quy trÃ¬nh cáº­p nháº­t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-soat-theo-moi-truong">
<span class="md-ellipsis">
      ğŸ“¦ Kiá»ƒm soÃ¡t theo mÃ´i trÆ°á»ng
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rollback-khi-loi">
<span class="md-ellipsis">
      ğŸ›‘ Rollback khi lá»—i
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y-khi-kiem-tra-version">
<span class="md-ellipsis">
      ğŸ§ª LÆ°u Ã½ khi kiá»ƒm tra version
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nhung-rui-ro-can-chu-y">
<span class="md-ellipsis">
      âš ï¸ Nhá»¯ng rá»§i ro cáº§n chÃº Ã½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#zero-downtime-deployment-canary-release-cloud-run">
<span class="md-ellipsis">
      âœ¨ Zero Downtime Deployment &amp; Canary Release (Cloud Run)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-quan-ly-pubsub-dead-letter">
<span class="md-ellipsis">
      8. Quáº£n lÃ½ Pub/Sub &amp; Dead Letter
    </span>
</a>
<nav aria-label="8. Quáº£n lÃ½ Pub/Sub &amp; Dead Letter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-topic-chinh">
<span class="md-ellipsis">
      ğŸ” CÃ¡c topic chÃ­nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dead-letter-topics-dlt">
<span class="md-ellipsis">
      ğŸ“¦ Dead Letter Topics (DLT)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#giam-sat-pubsub">
<span class="md-ellipsis">
      ğŸ” GiÃ¡m sÃ¡t Pub/Sub
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#handling-retry">
<span class="md-ellipsis">
      ğŸ›  Handling retry
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#debug-dlt-message">
<span class="md-ellipsis">
      âœï¸ Debug DLT message
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-kiem-soat-chi-phi-toi-uu-tai-nguyen">
<span class="md-ellipsis">
      9. Kiá»ƒm soÃ¡t chi phÃ­ &amp; tá»‘i Æ°u tÃ i nguyÃªn
    </span>
</a>
<nav aria-label="9. Kiá»ƒm soÃ¡t chi phÃ­ &amp; tá»‘i Æ°u tÃ i nguyÃªn" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cac-thanh-phan-ton-chi-phi">
<span class="md-ellipsis">
      ğŸ’° CÃ¡c thÃ nh pháº§n tá»‘n chi phÃ­
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#network-egress-costs">
<span class="md-ellipsis">
      ğŸŒ Network Egress Costs
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#theo-doi-chi-phi">
<span class="md-ellipsis">
      ğŸ“Š Theo dÃµi chi phÃ­
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chien-luoc-toi-uu">
<span class="md-ellipsis">
      ğŸ¯ Chiáº¿n lÆ°á»£c tá»‘i Æ°u
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#canh-bao-thuc-te">
<span class="md-ellipsis">
      âš ï¸ Cáº£nh bÃ¡o thá»±c táº¿
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-checklist-inh-ky-van-hanh">
<span class="md-ellipsis">
      10. Checklist Ä‘á»‹nh ká»³ váº­n hÃ nh
    </span>
</a>
<nav aria-label="10. Checklist Ä‘á»‹nh ká»³ váº­n hÃ nh" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#hang-tuan">
<span class="md-ellipsis">
      ğŸ” HÃ ng tuáº§n
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hang-thang">
<span class="md-ellipsis">
      ğŸ“… HÃ ng thÃ¡ng
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hang-quy">
<span class="md-ellipsis">
      ğŸ“£ HÃ ng quÃ½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cach-theo-doi-checklist">
<span class="md-ellipsis">
      ğŸ“Œ CÃ¡ch theo dÃµi checklist
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#11-ung-pho-su-co-khoi-phuc">
<span class="md-ellipsis">
      11. á»¨ng phÃ³ sá»± cá»‘ &amp; khÃ´i phá»¥c
    </span>
</a>
<nav aria-label="11. á»¨ng phÃ³ sá»± cá»‘ &amp; khÃ´i phá»¥c" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#vai-tro-trong-quy-trinh-ung-pho-su-co-incident-response-roles">
<span class="md-ellipsis">
      ğŸ§‘â€ğŸš’ Vai trÃ² trong quy trÃ¬nh á»©ng phÃ³ sá»± cá»‘ (Incident Response Roles)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phan-loai-su-co">
<span class="md-ellipsis">
      ğŸš¨ PhÃ¢n loáº¡i sá»± cá»‘
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#checklist-phan-ung-nhanh">
<span class="md-ellipsis">
      ğŸ§¯ Checklist pháº£n á»©ng nhanh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-cong-cu-ho-tro">
<span class="md-ellipsis">
      ğŸ—‚ Log &amp; cÃ´ng cá»¥ há»— trá»£
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#postmortem-template">
<span class="md-ellipsis">
      ğŸ“‹ Postmortem template
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12-backup-disaster-recovery-dr">
<span class="md-ellipsis">
      12. Backup &amp; Disaster Recovery (DR)
    </span>
</a>
<nav aria-label="12. Backup &amp; Disaster Recovery (DR)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#rto-rpo-muc-tieu">
<span class="md-ellipsis">
      ğŸ¯ RTO &amp; RPO má»¥c tiÃªu
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#backup-chien-luoc">
<span class="md-ellipsis">
      ğŸ“¦ Backup chiáº¿n lÆ°á»£c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-thu-dr-inh-ky">
<span class="md-ellipsis">
      ğŸ” Kiá»ƒm thá»­ DR Ä‘á»‹nh ká»³
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#luu-y-bao-mat">
<span class="md-ellipsis">
      ğŸ” LÆ°u Ã½ báº£o máº­t
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cong-cu-kiem-tra-khoi-phuc">
<span class="md-ellipsis">
      ğŸ§ª CÃ´ng cá»¥ kiá»ƒm tra &amp; khÃ´i phá»¥c
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#vi-du-kich-ban-dr-mat-ket-noi-cloud-sql">
<span class="md-ellipsis">
      ğŸ§ª VÃ­ dá»¥: Ká»‹ch báº£n DR â€“ Máº¥t káº¿t ná»‘i Cloud SQL
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#13-security-audit-compliance">
<span class="md-ellipsis">
      13. Security audit &amp; compliance
    </span>
</a>
<nav aria-label="13. Security audit &amp; compliance" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#kiem-tra-inh-ky">
<span class="md-ellipsis">
      ğŸ” Kiá»ƒm tra Ä‘á»‹nh ká»³
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lich-audit-goi-y">
<span class="md-ellipsis">
      ğŸ“… Lá»‹ch audit gá»£i Ã½
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cong-cu-ho-tro-audit">
<span class="md-ellipsis">
      ğŸ›  CÃ´ng cá»¥ há»— trá»£ audit
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#compliance-noi-bo">
<span class="md-ellipsis">
      ğŸ”’ Compliance (ná»™i bá»™)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#14-cong-cu-dashboard-ho-tro">
<span class="md-ellipsis">
      14. CÃ´ng cá»¥ &amp; dashboard há»— trá»£
    </span>
</a>
<nav aria-label="14. CÃ´ng cá»¥ &amp; dashboard há»— trá»£" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#bo-cong-cu-chinh">
<span class="md-ellipsis">
      ğŸ§° Bá»™ cÃ´ng cá»¥ chÃ­nh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dashboard-tham-khao">
<span class="md-ellipsis">
      ğŸ“Š Dashboard tham kháº£o
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bang-lenh-cli-devops-thuong-dung-gcp-cloud-run-pubsub-cloud-sql">
<span class="md-ellipsis">
      ğŸ§° Báº£ng lá»‡nh CLI DevOps thÆ°á»ng dÃ¹ng (GCP â€“ Cloud Run, Pub/Sub, Cloud SQL)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#uong-dan-huu-ich">
<span class="md-ellipsis">
      ğŸ“ ÄÆ°á»ng dáº«n há»¯u Ã­ch
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="ops-guide-dx-vas">ğŸ“˜ Ops Guide â€“ dx-vas<a class="headerlink" href="#ops-guide-dx-vas" title="Permanent link">Â¶</a></h1>
<p>TÃ i liá»‡u nÃ y dÃ nh cho DevOps/SRE váº­n hÃ nh há»‡ thá»‘ng dx-vas trÃªn mÃ´i trÆ°á»ng production vÃ  staging. Bao gá»“m giÃ¡m sÃ¡t, triá»ƒn khai, scaling, báº£o máº­t, kiá»ƒm tra sá»± cá»‘ vÃ  cÃ¡c quy trÃ¬nh váº­n hÃ nh thÆ°á»ng nháº­t.</p>
<hr/>
<h2 id="muc-luc">Má»¥c lá»¥c<a class="headerlink" href="#muc-luc" title="Permanent link">Â¶</a></h2>
<ol>
<li><a href="#1-tá»•ng-quan-triá»ƒn-khai-háº¡-táº§ng">Tá»•ng quan triá»ƒn khai háº¡ táº§ng</a></li>
<li><a href="#2-triá»ƒn-khai-dá»‹ch-vá»¥--mÃ´i-trÆ°á»ng">Triá»ƒn khai dá»‹ch vá»¥ &amp; mÃ´i trÆ°á»ng</a></li>
<li><a href="#3-giÃ¡m-sÃ¡t--cáº£nh-bÃ¡o">GiÃ¡m sÃ¡t &amp; cáº£nh bÃ¡o</a></li>
<li><a href="#4-logging--trace-phÃ¢n-tÃ¡n">Logging &amp; Trace phÃ¢n tÃ¡n</a></li>
<li><a href="#5-quáº£n-lÃ½-báº£o-máº­t--credentials">Quáº£n lÃ½ báº£o máº­t &amp; credentials</a></li>
<li><a href="#6-chiáº¿n-lÆ°á»£c-scaling--autoscale">Chiáº¿n lÆ°á»£c scaling &amp; autoscale</a></li>
<li><a href="#7-quy-trÃ¬nh-cáº­p-nháº­t--rollback">Quy trÃ¬nh cáº­p nháº­t &amp; rollback</a></li>
<li><a href="#8-quáº£n-lÃ½-pubsub--dead-letter">Quáº£n lÃ½ Pub/Sub &amp; Dead Letter</a></li>
<li><a href="#9-kiá»ƒm-soÃ¡t-chi-phÃ­--tá»‘i-Æ°u-tÃ i-nguyÃªn">Kiá»ƒm soÃ¡t chi phÃ­ &amp; tá»‘i Æ°u tÃ i nguyÃªn</a></li>
<li><a href="#10-checklist-Ä‘á»‹nh-ká»³-váº­n-hÃ nh">Checklist Ä‘á»‹nh ká»³ váº­n hÃ nh</a></li>
<li><a href="#11-á»©ng-phÃ³-sá»±-cá»‘--khÃ´i-phá»¥c">á»¨ng phÃ³ sá»± cá»‘ &amp; khÃ´i phá»¥c</a></li>
<li><a href="#12-backup--disaster-recovery-dr">Backup &amp; Disaster Recovery (DR)</a></li>
<li><a href="#13-security-audit--compliance">Security audit &amp; compliance</a></li>
<li><a href="#14-cÃ´ng-cá»¥--dashboard-há»—-trá»£">CÃ´ng cá»¥ &amp; dashboard há»— trá»£</a></li>
</ol>
<hr/>
<h2 id="1-tong-quan-trien-khai-ha-tang">1. Tá»•ng quan triá»ƒn khai háº¡ táº§ng<a class="headerlink" href="#1-tong-quan-trien-khai-ha-tang" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas Ä‘Æ°á»£c triá»ƒn khai hoÃ n toÃ n trÃªn háº¡ táº§ng <strong>Google Cloud Platform (GCP)</strong>, sá»­ dá»¥ng cÃ¡c dá»‹ch vá»¥ serverless vÃ  managed Ä‘á»ƒ Ä‘áº£m báº£o kháº£ nÄƒng má»Ÿ rá»™ng, báº£o trÃ¬ Ä‘Æ¡n giáº£n vÃ  váº­n hÃ nh á»•n Ä‘á»‹nh.</p>
<hr/>
<h3 id="kien-truc-trien-khai-chinh">âš™ï¸ Kiáº¿n trÃºc triá»ƒn khai chÃ­nh<a class="headerlink" href="#kien-truc-trien-khai-chinh" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>ThÃ nh pháº§n</th>
<th>Triá»ƒn khai trÃªn</th>
<th>Ghi chÃº</th>
</tr>
</thead>
<tbody>
<tr>
<td>API Gateway</td>
<td>Cloud Run</td>
<td>Kiá»ƒm soÃ¡t truy cáº­p, kiá»ƒm tra RBAC</td>
</tr>
<tr>
<td>Core Services (Auth, User, Notification)</td>
<td>Cloud Run</td>
<td>Äá»™c láº­p, stateless</td>
</tr>
<tr>
<td>Business Adapters (CRM/SIS/LMS)</td>
<td>Cloud Run</td>
<td>Káº¿t ná»‘i há»‡ thá»‘ng bÃªn ngoÃ i</td>
</tr>
<tr>
<td>Redis Cache</td>
<td>Memorystore</td>
<td>LÆ°u RBAC cache, token, session</td>
</tr>
<tr>
<td>PostgreSQL (Core)</td>
<td>Cloud SQL</td>
<td>CSDL chÃ­nh cho RBAC, ngÆ°á»i dÃ¹ng</td>
</tr>
<tr>
<td>MySQL (Adapters)</td>
<td>Cloud SQL</td>
<td>TÆ°Æ¡ng thÃ­ch vá»›i há»‡ thá»‘ng CRM/SIS/LMS</td>
</tr>
<tr>
<td>Pub/Sub</td>
<td>GCP Pub/Sub</td>
<td>Event bus cho Notification &amp; Sync</td>
</tr>
<tr>
<td>GCS</td>
<td>Google Cloud Storage</td>
<td>LÆ°u trá»¯ áº£nh, file tÄ©nh, JSON config</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="ha-tang-phan-tang">â˜ï¸ Háº¡ táº§ng phÃ¢n táº§ng<a class="headerlink" href="#ha-tang-phan-tang" title="Permanent link">Â¶</a></h3>
<ul>
<li><strong>Cloud Run</strong>: Má»—i service lÃ  má»™t container riÃªng biá»‡t, autoscale theo lÆ°u lÆ°á»£ng.</li>
<li><strong>Cloud SQL</strong>: Instance riÃªng cho PostgreSQL (core) vÃ  MySQL (adapters), báº­t PITR.</li>
<li><strong>VPC &amp; firewall rules</strong>: Táº¥t cáº£ Cloud Run â†’ DB hoáº·c Redis Ä‘á»u qua VPC connector.</li>
<li><strong>IAM &amp; Secret Manager</strong>: Quáº£n lÃ½ phÃ¢n quyá»n truy cáº­p service-level vÃ  secrets.</li>
</ul>
<hr/>
<h3 id="moi-truong-trien-khai">ğŸ—‚ï¸ MÃ´i trÆ°á»ng triá»ƒn khai<a class="headerlink" href="#moi-truong-trien-khai" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>MÃ´i trÆ°á»ng</th>
<th>NhÃ¡nh Git</th>
<th>Ghi chÃº</th>
</tr>
</thead>
<tbody>
<tr>
<td>Staging</td>
<td><code>dev</code></td>
<td>Tá»± Ä‘á»™ng deploy khi merge PR</td>
</tr>
<tr>
<td>Production</td>
<td><code>main</code></td>
<td>Deploy cÃ³ approval</td>
</tr>
</tbody>
</table>
<hr/>
<p>ğŸ“ SÆ¡ Ä‘á»“ kiáº¿n trÃºc tá»•ng quan: <a href="../../architecture/system-diagrams/#9-deployment-overview-diagram--sÆ¡-Ä‘á»“-triá»ƒn-khai-tá»•ng-quan">System Diagrams</a></p>
<p>ğŸ“ Chi tiáº¿t RBAC: <a href="../../architecture/rbac-deep-dive/">RBAC Deep Dive</a></p>
<hr/>
<h2 id="2-trien-khai-dich-vu-moi-truong">2. Triá»ƒn khai dá»‹ch vá»¥ &amp; mÃ´i trÆ°á»ng<a class="headerlink" href="#2-trien-khai-dich-vu-moi-truong" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas gá»“m nhiá»u service Ä‘á»™c láº­p, má»—i service lÃ  má»™t Dockerized microservice Ä‘Æ°á»£c triá»ƒn khai lÃªn <strong>Google Cloud Run</strong>. Má»—i service cÃ³ repository riÃªng biá»‡t, CI/CD riÃªng, vÃ  tÃ¡ch biá»‡t giá»¯a staging vÃ  production.</p>
<hr/>
<h3 id="mo-hinh-multi-repo">ğŸ“¦ MÃ´ hÃ¬nh multi-repo<a class="headerlink" href="#mo-hinh-multi-repo" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Service</th>
<th>Repo</th>
<th>CI/CD</th>
<th>Port dev</th>
</tr>
</thead>
<tbody>
<tr>
<td>API Gateway</td>
<td><code>dx-api-gateway</code></td>
<td>GitHub Actions â†’ Cloud Run</td>
<td>8080</td>
</tr>
<tr>
<td>Auth Service</td>
<td><code>dx-auth-service</code></td>
<td>GitHub Actions â†’ Cloud Run</td>
<td>8001</td>
</tr>
<tr>
<td>User Service</td>
<td><code>dx-user-service</code></td>
<td>GitHub Actions â†’ Cloud Run</td>
<td>8002</td>
</tr>
<tr>
<td>Notification Service</td>
<td><code>dx-notification-service</code></td>
<td>GitHub Actions â†’ Cloud Run</td>
<td>8003</td>
</tr>
<tr>
<td>CRM Adapter</td>
<td><code>dx-crm-adapter</code></td>
<td>GitHub Actions â†’ Cloud Run</td>
<td>8011</td>
</tr>
<tr>
<td>SIS Adapter</td>
<td><code>dx-sis-adapter</code></td>
<td>GitHub Actions â†’ Cloud Run</td>
<td>8012</td>
</tr>
<tr>
<td>LMS Adapter</td>
<td><code>dx-lms-adapter</code></td>
<td>GitHub Actions â†’ Cloud Run</td>
<td>8013</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="quy-trinh-trien-khai-ien-hinh">ğŸ§± Quy trÃ¬nh triá»ƒn khai Ä‘iá»ƒn hÃ¬nh<a class="headerlink" href="#quy-trinh-trien-khai-ien-hinh" title="Permanent link">Â¶</a></h3>
<ol>
<li>Developer push code lÃªn nhÃ¡nh <code>dev</code></li>
<li>CI cháº¡y test + lint + security scan</li>
<li>Náº¿u pass:</li>
<li>Tá»± Ä‘á»™ng build image â†’ upload Container Registry (Artifact Registry)</li>
<li>Deploy lÃªn Cloud Run mÃ´i trÆ°á»ng Staging</li>
<li>Vá»›i <code>main</code>:</li>
<li>Chá»‰ Ä‘Æ°á»£c merge khi cÃ³ 2 approval</li>
<li>YÃªu cáº§u xÃ¡c nháº­n deploy â†’ Production</li>
</ol>
<hr/>
<h3 id="cau-hinh-deploy-vi-du-github-actions">ğŸ›  Cáº¥u hÃ¬nh deploy (vÃ­ dá»¥ GitHub Actions)<a class="headerlink" href="#cau-hinh-deploy-vi-du-github-actions" title="Permanent link">Â¶</a></h3>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deploy to Cloud Run</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">google-github-actions/deploy-cloudrun@v1</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">  </span><span class="nt">with</span><span class="p">:</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user-service</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcr.io/$PROJECT_ID/user-service:$GITHUB_SHA</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asia-southeast1</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="nt">env_vars</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ENV=${{ github.ref == 'refs/heads/main' &amp;&amp; 'production' || 'staging' }}</span>
</span></code></pre></div>
<p>ğŸ“Œ Trong workflow thá»±c táº¿, biáº¿n ENV khÃ´ng gÃ¡n cá»©ng mÃ  Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh tá»± Ä‘á»™ng dá»±a trÃªn nhÃ¡nh (hoáº·c GitHub environment). CÃ³ thá»ƒ sá»­ dá»¥ng biáº¿n github.ref hoáº·c GitHub Environments (production, staging) Ä‘á»ƒ thiáº¿t láº­p Ä‘Ãºng biáº¿n mÃ´i trÆ°á»ng cho Cloud Run.</p>
<hr/>
<h3 id="cau-hinh-bien-moi-truong-cloud-run">ğŸ“ Cáº¥u hÃ¬nh biáº¿n mÃ´i trÆ°á»ng (Cloud Run)<a class="headerlink" href="#cau-hinh-bien-moi-truong-cloud-run" title="Permanent link">Â¶</a></h3>
<ul>
<li>DÃ¹ng Secret Manager Ä‘á»ƒ lÆ°u token nháº¡y cáº£m</li>
<li>CÃ¡c biáº¿n <code>.env</code> Ä‘Æ°á»£c sync thÃ´ng qua deploy script</li>
<li>Má»™t sá»‘ biáº¿n mÃ´i trÆ°á»ng Ä‘iá»ƒn hÃ¬nh:</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>ENV=production
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>DATABASE_URL=...
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>REDIS_URL=...
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>JWT_SECRET=...
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>PUBSUB_PROJECT_ID=...
</span></code></pre></div>
<hr/>
<p>ğŸ“ Chi tiáº¿t CI/CD: <a href="../dev-guide/#8-quy-trÃ¬nh-test--ci-cd">Dev Guide</a></p>
<p>ğŸ“ Cáº¥u trÃºc mÃ´i trÆ°á»ng Cloud Run: <a href="../../architecture/system-diagrams/#9-deployment-overview-diagram--sÆ¡-Ä‘á»“-triá»ƒn-khai-tá»•ng-quan">System Diagrams</a></p>
<hr/>
<h2 id="3-giam-sat-canh-bao">3. GiÃ¡m sÃ¡t &amp; cáº£nh bÃ¡o<a class="headerlink" href="#3-giam-sat-canh-bao" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas sá»­ dá»¥ng Google Cloud Monitoring Ä‘á»ƒ theo dÃµi tráº¡ng thÃ¡i dá»‹ch vá»¥, hiá»‡u nÄƒng, tá»‰ lá»‡ lá»—i vÃ  thiáº¿t láº­p cáº£nh bÃ¡o theo rule tÃ¹y chá»‰nh. Má»—i service Ä‘Æ°á»£c giÃ¡m sÃ¡t Ä‘á»™c láº­p vÃ  cÃ³ dashboard riÃªng.</p>
<hr/>
<h3 id="cac-loai-metric-giam-sat">ğŸ“Š CÃ¡c loáº¡i metric giÃ¡m sÃ¡t<a class="headerlink" href="#cac-loai-metric-giam-sat" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>NhÃ³m</th>
<th>Metric</th>
<th>VÃ­ dá»¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cloud Run</td>
<td>Request count, latency, error rate</td>
<td>5xx tÄƒng báº¥t thÆ°á»ng</td>
</tr>
<tr>
<td>Pub/Sub</td>
<td>Pending messages, retry count</td>
<td>Queue bá»‹ káº¹t</td>
</tr>
<tr>
<td>Redis</td>
<td>Miss rate, latency</td>
<td>Cache cháº­m hoáº·c máº¥t</td>
</tr>
<tr>
<td>Database</td>
<td>Connection usage, slow queries</td>
<td>PostgreSQL / MySQL</td>
</tr>
<tr>
<td>RBAC</td>
<td>Permission denied, cache invalidated</td>
<td>Sá»± kiá»‡n báº£o máº­t</td>
</tr>
<tr>
<td>Notification</td>
<td>Success/failure rate theo kÃªnh</td>
<td>Zalo/Gmail tháº¥t báº¡i</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="alerting-rule-goi-y">âš ï¸ Alerting rule gá»£i Ã½<a class="headerlink" href="#alerting-rule-goi-y" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Rule</th>
<th>Äiá»u kiá»‡n</th>
<th>Severity</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gateway error spike</td>
<td>5xx &gt; 20% trong 5 phÃºt</td>
<td>ğŸ”¥ Critical</td>
</tr>
<tr>
<td>Redis miss tÄƒng cao</td>
<td>Miss rate &gt; 50% trong 10 phÃºt</td>
<td>âš ï¸ Warning</td>
</tr>
<tr>
<td>Pub/Sub backlog</td>
<td>&gt; 500 messages trong 5 phÃºt</td>
<td>âš ï¸ Warning</td>
</tr>
<tr>
<td>ÄÄƒng nháº­p tháº¥t báº¡i</td>
<td>&gt; 10 láº§n tá»« 1 IP trong 1 phÃºt</td>
<td>ğŸš¨ Security</td>
</tr>
<tr>
<td>DB connection full</td>
<td>Sá»­ dá»¥ng &gt; 90% connection pool</td>
<td>ğŸ”¥ Critical</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="dashboard-e-xuat">ğŸ“‰ Dashboard Ä‘á» xuáº¥t<a class="headerlink" href="#dashboard-e-xuat" title="Permanent link">Â¶</a></h3>
<ul>
<li>Má»™t dashboard chung toÃ n há»‡ thá»‘ng (multi-service)</li>
<li>Dashboard riÃªng cho tá»«ng service:</li>
<li><code>gateway-dashboard</code></li>
<li><code>auth-dashboard</code></li>
<li><code>user-dashboard</code></li>
<li><code>notification-dashboard</code></li>
<li>CÃ³ thá»ƒ dÃ¹ng dashboard template tá»« Google Cloud Monitoring</li>
</ul>
<hr/>
<h3 id="canh-bao-thong-bao">ğŸ”„ Cáº£nh bÃ¡o &amp; thÃ´ng bÃ¡o<a class="headerlink" href="#canh-bao-thong-bao" title="Permanent link">Â¶</a></h3>
<ul>
<li>Cáº£nh bÃ¡o gá»­i qua:</li>
<li>Google Chat (devops channel)</li>
<li>Email (alerts@truongvietanh.edu.vn)</li>
<li>Äá»‹nh ká»³ audit cáº£nh bÃ¡o sai lá»‡ch hoáº·c trÃ¹ng láº·p</li>
</ul>
<hr/>
<h3 id="so-o-luong-canh-bao-monitoring-alerts">ğŸ›ï¸ SÆ¡ Ä‘á»“ luá»“ng cáº£nh bÃ¡o (Monitoring Alerts)<a class="headerlink" href="#so-o-luong-canh-bao-monitoring-alerts" title="Permanent link">Â¶</a></h3>
<pre class="mermaid"><code>flowchart TD
    A[Service Metrics <br/> Cloud Run, Redis, DB...]
    B[Cloud Monitoring]
    C[Alert Policy <br/> Threshold Rules]
    D[Notification Channel <br/> Google Chat, Email]
    E[Incident Response <br/> Ops team]

    A --&gt; B
    B --&gt; C
    C --&gt; D
    D --&gt; E

    click C href "https://console.cloud.google.com/monitoring/alerting" "View Alerting Policy"
    click D href "https://console.cloud.google.com/monitoring/settings" "View Notification Settings"
</code></pre>
<p><strong>Giáº£i thÃ­ch:</strong></p>
<ol>
<li><strong>Service Metrics:</strong> Metrics Ä‘Æ°á»£c export tá»« Cloud Run, Redis, Cloud SQL, v.v. (VD: CPU usage, 5xx error rate).</li>
<li><strong>Cloud Monitoring:</strong> Thu tháº­p vÃ  phÃ¢n tÃ­ch cÃ¡c metric.</li>
<li><strong>Alert Policy:</strong> Äá»‹nh nghÄ©a ngÆ°á»¡ng cáº£nh bÃ¡o (vÃ­ dá»¥: náº¿u error rate &gt; 5% trong 1 phÃºt).</li>
<li><strong>Notification Channel:</strong> Khi cÃ³ cáº£nh bÃ¡o, há»‡ thá»‘ng gá»­i tá»›i cÃ¡c kÃªnh nhÆ° Google Chat, Email, PagerDuty (náº¿u cÃ³).</li>
<li><strong>Incident Response:</strong> Äá»™i ngÅ© váº­n hÃ nh nháº­n cáº£nh bÃ¡o vÃ  thá»±c hiá»‡n xá»­ lÃ½ theo Runbook.</li>
</ol>
<p>ğŸ“Œ CÃ¡c bÆ°á»›c tiáº¿p theo cÃ³ thá»ƒ Ä‘Æ°á»£c trigger tá»± Ä‘á»™ng (gá»­i cáº£nh bÃ¡o qua bot, má»Ÿ ticket, cáº­p nháº­t dashboardâ€¦). Báº¡n cÃ³ thá»ƒ nhÃºng thÃªm link hoáº·c má»Ÿ rá»™ng náº¿u dÃ¹ng Alertmanager hoáº·c bÃªn thá»© ba nhÆ° OpsGenie, PagerDuty.</p>
<hr/>
<p>ğŸ“ Xem thÃªm cáº¥u trÃºc trace/log táº¡i: <a href="#4-logging--trace-phÃ¢n-tÃ¡n">Má»¥c 4 â€“ Logging &amp; Trace</a> </p>
<p>ğŸ“ Äá»‹nh nghÄ©a dashboard: <a href="../observability/">Observability</a></p>
<hr/>
<h2 id="4-logging-trace-phan-tan">4. Logging &amp; Trace phÃ¢n tÃ¡n<a class="headerlink" href="#4-logging-trace-phan-tan" title="Permanent link">Â¶</a></h2>
<p>Má»i service trong dx-vas Ä‘á»u ghi log theo Ä‘á»‹nh dáº¡ng JSON chuáº©n hÃ³a, cÃ³ gáº¯n <code>request_id</code>, vÃ  gá»­i vá» Google Cloud Logging. Há»‡ thá»‘ng Ä‘á»“ng thá»i há»— trá»£ tracing phÃ¢n tÃ¡n vá»›i Google Cloud Trace Ä‘á»ƒ theo dÃµi luá»“ng xá»­ lÃ½ xuyÃªn suá»‘t nhiá»u service.</p>
<hr/>
<h3 id="inh-dang-log-chuan">ğŸ§¾ Äá»‹nh dáº¡ng log chuáº©n<a class="headerlink" href="#inh-dang-log-chuan" title="Permanent link">Â¶</a></h3>
<div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">  </span><span class="nt">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-06-01T10:15:00Z"</span><span class="p">,</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">  </span><span class="nt">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INFO"</span><span class="p">,</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">  </span><span class="nt">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user-service"</span><span class="p">,</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">  </span><span class="nt">"request_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"req-123456"</span><span class="p">,</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"User updated successfully"</span><span class="p">,</span>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">  </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"u789"</span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="luu-y">ğŸ“Œ LÆ°u Ã½:<a class="headerlink" href="#luu-y" title="Permanent link">Â¶</a></h4>
<ul>
<li>Log theo cáº¥u trÃºc (structured logging) Ä‘á»ƒ dá»… filter vÃ  alert</li>
<li>Gáº¯n <code>request_id</code> xuyÃªn suá»‘t: tá»« client â†’ gateway â†’ service â†’ pub/sub</li>
</ul>
<hr/>
<h3 id="trace-phan-tan">ğŸ” Trace phÃ¢n tÃ¡n<a class="headerlink" href="#trace-phan-tan" title="Permanent link">Â¶</a></h3>
<ul>
<li>Má»—i request Ä‘á»u gáº¯n <code>X-Request-ID</code> vÃ  <code>X-Trace-ID</code></li>
<li>Gateway khá»Ÿi táº¡o trace â†’ propagate xuá»‘ng cÃ¡c service</li>
<li>Google Cloud Trace ghi nháº­n timeline xuyÃªn service (gá»i API, DB, Pub/Sub...)</li>
</ul>
<hr/>
<h3 id="su-dung-log-trace">ğŸ“Š Sá»­ dá»¥ng log &amp; trace<a class="headerlink" href="#su-dung-log-trace" title="Permanent link">Â¶</a></h3>
<ul>
<li>TÃ¬m theo <code>request_id</code>: truy váº¿t lá»—i logic liÃªn service</li>
<li>So sÃ¡nh <code>start_time</code> â€“ <code>end_time</code>: Ä‘o Ä‘á»™ trá»… tá»«ng hop</li>
<li>Lá»c theo <code>level: ERROR</code>: phÃ¡t hiá»‡n service máº¥t á»•n Ä‘á»‹nh</li>
<li>Trace cÃ¡c retry / fail event tá»« Notification, RBAC, Auth</li>
</ul>
<hr/>
<h3 id="goi-y-log-prefix">ğŸ—‚ï¸ Gá»£i Ã½ log prefix<a class="headerlink" href="#goi-y-log-prefix" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>ThÃ nh pháº§n</th>
<th>Prefix gá»£i Ã½</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gateway</td>
<td><code>[GATEWAY]</code></td>
</tr>
<tr>
<td>Auth Service</td>
<td><code>[AUTH]</code></td>
</tr>
<tr>
<td>User Service</td>
<td><code>[USER]</code></td>
</tr>
<tr>
<td>Notification</td>
<td><code>[NOTI]</code></td>
</tr>
<tr>
<td>RBAC</td>
<td><code>[RBAC]</code></td>
</tr>
<tr>
<td>Redis</td>
<td><code>[CACHE]</code></td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="log-bao-mat">ğŸ” Log báº£o máº­t<a class="headerlink" href="#log-bao-mat" title="Permanent link">Â¶</a></h3>
<ul>
<li>
<p>Log cÃ¡c sá»± kiá»‡n nháº¡y cáº£m:</p>
</li>
<li>
<p>ÄÄƒng nháº­p sai, lock tÃ i khoáº£n</p>
</li>
<li>Thay Ä‘á»•i role/permission</li>
<li>Lá»—i RBAC condition</li>
</ul>
<hr/>
<p>ğŸ“ HÆ°á»›ng dáº«n chi tiáº¿t log/tracing: <a href="../../ADR/adr-008-audit-logging/"><code>adr-008-audit-logging.md</code></a></p>
<p>ğŸ“ Cáº¥u trÃºc trace â†’ diagram: <a href="../../architecture/system-diagrams/#4-rbac-evaluation-flow--luá»“ng-Ä‘Ã¡nh-giÃ¡-phÃ¢n-quyá»n-Ä‘á»™ng">System Diagrams</a></p>
<hr/>
<h2 id="5-quan-ly-bao-mat-credentials">5. Quáº£n lÃ½ báº£o máº­t &amp; credentials<a class="headerlink" href="#5-quan-ly-bao-mat-credentials" title="Permanent link">Â¶</a></h2>
<p>Táº¥t cáº£ thÃ´ng tin nháº¡y cáº£m nhÆ° token, secret, key API Ä‘á»u Ä‘Æ°á»£c quáº£n lÃ½ qua <strong>Google Secret Manager</strong>, cÃ³ kiá»ƒm soÃ¡t quyá»n truy cáº­p báº±ng IAM. KhÃ´ng Ä‘á»ƒ báº¥t ká»³ credential nÃ o trong repo code hoáº·c biáº¿n mÃ´i trÆ°á»ng cÃ´ng khai.</p>
<hr/>
<h3 id="loai-thong-tin-can-bao-ve">ğŸ” Loáº¡i thÃ´ng tin cáº§n báº£o vá»‡<a class="headerlink" href="#loai-thong-tin-can-bao-ve" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Loáº¡i</th>
<th>VÃ­ dá»¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>JWT secret</td>
<td><code>JWT_SECRET</code>, <code>REFRESH_SECRET</code></td>
</tr>
<tr>
<td>OAuth credentials</td>
<td>Google OAuth Client ID/Secret</td>
</tr>
<tr>
<td>Redis password</td>
<td><code>REDIS_AUTH</code> náº¿u báº­t ACL</td>
</tr>
<tr>
<td>DB credentials</td>
<td><code>DATABASE_URL</code></td>
</tr>
<tr>
<td>API key bÃªn thá»© ba</td>
<td>Zalo OA, Gmail API</td>
</tr>
<tr>
<td>Webhook URL</td>
<td>Google Chat, Slack alerting</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="quan-ly-cau-hinh-ong-khong-nhay-cam">ğŸ§© Quáº£n lÃ½ cáº¥u hÃ¬nh Ä‘á»™ng (khÃ´ng nháº¡y cáº£m)<a class="headerlink" href="#quan-ly-cau-hinh-ong-khong-nhay-cam" title="Permanent link">Â¶</a></h3>
<p>NgoÃ i credentials, há»‡ thá»‘ng cÃ³ thá»ƒ cáº§n cáº¥u hÃ¬nh cÃ¡c giÃ¡ trá»‹ Ä‘á»™ng nhÆ°:</p>
<ul>
<li>Feature flags</li>
<li>NgÆ°á»¡ng cáº£nh bÃ¡o tÃ¹y chá»‰nh</li>
<li>Cáº¥u hÃ¬nh luá»“ng nghiá»‡p vá»¥</li>
</ul>
<p>ğŸ“Œ dx_vas hiá»‡n há»— trá»£ Ä‘á»c cÃ¡c cáº¥u hÃ¬nh Ä‘á»™ng tá»«:</p>
<ul>
<li><strong>Google Cloud Storage (GCS)</strong>: chá»©a file <code>.json</code> cáº¥u hÃ¬nh chung (VD: <code>config/global.json</code>)</li>
<li><strong>Firestore (option)</strong>: náº¿u cáº§n cáº­p nháº­t realtime (VD: cáº¥u hÃ¬nh theo ngÆ°á»i dÃ¹ng, theo campus)</li>
<li><strong>Hardcoded YAML</strong> (cÃ³ kiá»ƒm soÃ¡t qua Git): dÃ¹ng cho cáº¥u hÃ¬nh Ã­t thay Ä‘á»•i nhÆ° RBAC schema</li>
</ul>
<blockquote>
<p>âœ… Má»i thay Ä‘á»•i cáº¥u hÃ¬nh cáº§n version, audit vÃ  trÃ¡nh cáº­p nháº­t runtime náº¿u khÃ´ng kiá»ƒm soÃ¡t rollback.</p>
</blockquote>
<hr/>
<h3 id="quy-trinh-quan-ly-secret">ğŸ§± Quy trÃ¬nh quáº£n lÃ½ secret<a class="headerlink" href="#quy-trinh-quan-ly-secret" title="Permanent link">Â¶</a></h3>
<ol>
<li>Táº¡o secret trÃªn GCP:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>gcloud<span class="w"> </span>secrets<span class="w"> </span>create<span class="w"> </span>dx-auth-jwt-secret<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span>--replication-policy<span class="w"> </span>automatic
</span></code></pre></div>
<ol>
<li>Upload version:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">"supersecret123"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gcloud<span class="w"> </span>secrets<span class="w"> </span>versions<span class="w"> </span>add<span class="w"> </span>dx-auth-jwt-secret<span class="w"> </span>--data-file<span class="o">=</span>-
</span></code></pre></div>
<ol>
<li>GÃ¡n quyá»n IAM cho Cloud Run:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>gcloud<span class="w"> </span>secrets<span class="w"> </span>add-iam-policy-binding<span class="w"> </span>dx-auth-jwt-secret<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span>--member<span class="o">=</span>serviceAccount:auth-service@PROJECT_ID.iam.gserviceaccount.com<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">  </span>--role<span class="o">=</span>roles/secretmanager.secretAccessor
</span></code></pre></div>
<ol>
<li>Truy xuáº¥t trong runtime (qua ENV hoáº·c SDK)</li>
</ol>
<hr/>
<h3 id="thuc-hanh-tot">ğŸ“¦ Thá»±c hÃ nh tá»‘t<a class="headerlink" href="#thuc-hanh-tot" title="Permanent link">Â¶</a></h3>
<ul>
<li>Secret chá»‰ cáº¥p quyá»n <code>read</code>, khÃ´ng <code>write</code> tá»« service</li>
<li>Rotate Ä‘á»‹nh ká»³ má»—i 90 ngÃ y</li>
<li>Báº¯t buá»™c audit náº¿u secret bá»‹ thay Ä‘á»•i</li>
<li>KhÃ´ng Ä‘á»ƒ <code>.env</code> chá»©a secret trong repo â€“ dÃ¹ng <code>.env.example</code></li>
</ul>
<hr/>
<h3 id="kiem-tra-nhanh">ğŸ§ª Kiá»ƒm tra nhanh<a class="headerlink" href="#kiem-tra-nhanh" title="Permanent link">Â¶</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>gcloud<span class="w"> </span>secrets<span class="w"> </span>list
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>gcloud<span class="w"> </span>secrets<span class="w"> </span>versions<span class="w"> </span>list<span class="w"> </span>dx-auth-jwt-secret
</span></code></pre></div>
<hr/>
<p>ğŸ“ ChÃ­nh sÃ¡ch báº£o máº­t chi tiáº¿t: <a href="../../ADR/adr-003-secrets/"><code>adr-003-secrets.md</code></a></p>
<p>ğŸ“ Tá»•ng quan báº£o máº­t toÃ n há»‡ thá»‘ng: <a href="../dev-guide/#11-theo-dÃµi--váº­n-hÃ nh">Dev Guide â€“ Má»¥c 11.3</a></p>
<hr/>
<h2 id="6-chien-luoc-scaling-autoscale">6. Chiáº¿n lÆ°á»£c scaling &amp; autoscale<a class="headerlink" href="#6-chien-luoc-scaling-autoscale" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas sá»­ dá»¥ng <strong>Google Cloud Run</strong> Ä‘á»ƒ triá»ƒn khai toÃ n bá»™ service backend. Cloud Run cung cáº¥p kháº£ nÄƒng autoscale theo sá»‘ lÆ°á»£ng request, Ä‘áº£m báº£o há»‡ thá»‘ng luÃ´n pháº£n há»“i nhanh nhÆ°ng tiáº¿t kiá»‡m tÃ i nguyÃªn.</p>
<hr/>
<h3 id="autoscaling-mac-inh">âš™ï¸ Autoscaling máº·c Ä‘á»‹nh<a class="headerlink" href="#autoscaling-mac-inh" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Service</th>
<th>Min instance</th>
<th>Max instance</th>
<th>Concurrency (requests/instance)</th>
<th>Ghi chÃº</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gateway</td>
<td>2</td>
<td>50</td>
<td>10</td>
<td>LuÃ´n duy trÃ¬ sáºµn sÃ ng</td>
</tr>
<tr>
<td>Auth/User</td>
<td>1</td>
<td>20</td>
<td>10</td>
<td>Core services, nháº¡y cáº£m vá»›i Ä‘á»™ trá»…</td>
</tr>
<tr>
<td>Notification</td>
<td>0</td>
<td>30</td>
<td>20</td>
<td>CÃ³ thá»ƒ burst cao khi gá»­i hÃ ng loáº¡t</td>
</tr>
<tr>
<td>Adapters</td>
<td>0</td>
<td>10</td>
<td>10</td>
<td>TÃ¹y theo má»©c Ä‘á»™ tÃ­ch há»£p (CRM, SIS, LMS)</td>
</tr>
</tbody>
</table>
<p>ğŸ“Œ GiÃ¡ trá»‹ concurrency máº·c Ä‘á»‹nh cá»§a Cloud Run lÃ  <code>80 requests/instance</code>. Há»‡ thá»‘ng dx-vas Ä‘Ã£ cáº¥u hÃ¬nh láº¡i (giáº£m) Ä‘á»ƒ Ä‘áº£m báº£o Ä‘á»™ trá»… tháº¥p cho cÃ¡c service xá»­ lÃ½ dá»¯ liá»‡u nháº¡y cáº£m nhÆ° Auth vÃ  User.</p>
<hr/>
<h3 id="hanh-vi-scaling">ğŸ” HÃ nh vi scaling<a class="headerlink" href="#hanh-vi-scaling" title="Permanent link">Â¶</a></h3>
<ul>
<li>TÄƒng instance khi sá»‘ lÆ°á»£ng request vÆ°á»£t concurrency threshold</li>
<li>Giáº£m instance khi idle trong má»™t thá»i gian (15 phÃºt máº·c Ä‘á»‹nh)</li>
<li>Cloud Run Ä‘áº£m báº£o má»—i container xá»­ lÃ½ tá»‘i Ä‘a <code>CONCURRENCY</code> request cÃ¹ng lÃºc</li>
</ul>
<hr/>
<h3 id="toi-uu-scaling">ğŸ“‰ Tá»‘i Æ°u scaling<a class="headerlink" href="#toi-uu-scaling" title="Permanent link">Â¶</a></h3>
<ul>
<li>Sá»­ dá»¥ng health check <code>/healthz</code> Ä‘á»ƒ loáº¡i bá» container lá»—i khá»i autoscaler</li>
<li>Log metric <code>request count</code>, <code>concurrency</code>, <code>latency</code> Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ scaling thá»±c táº¿</li>
<li>CÃ³ thá»ƒ gÃ¡n háº¡n má»©c chi phÃ­/quotas cho tá»«ng service náº¿u cáº§n kiá»ƒm soÃ¡t táº£i</li>
</ul>
<hr/>
<h3 id="luu-y_1">ğŸ” LÆ°u Ã½<a class="headerlink" href="#luu-y_1" title="Permanent link">Â¶</a></h3>
<ul>
<li>LuÃ´n báº­t min instance = 1 vá»›i Auth vÃ  User Service Ä‘á»ƒ giáº£m cold start</li>
<li>Sá»­ dá»¥ng VPC Connector cho Cloud SQL/Redis â€“ Ä‘áº£m báº£o scaling khÃ´ng bá»‹ ngháº½n</li>
<li>KhÃ´ng scale vÃ´ háº¡n: max instance cáº§n Ä‘Æ°á»£c cáº¥u hÃ¬nh phÃ¹ há»£p Ä‘á»ƒ trÃ¡nh quÃ¡ táº£i DB</li>
</ul>
<hr/>
<p>ğŸ“ Cáº¥u trÃºc triá»ƒn khai: <a href="../../architecture/system-diagrams/#9-deployment-overview-diagram--sÆ¡-Ä‘á»“-triá»ƒn-khai-tá»•ng-quan">System Diagrams</a> </p>
<p>ğŸ“ Tham kháº£o thÃªm: <a href="../dev-guide/#8-quy-trÃ¬nh-test--ci-cd">Dev Guide</a></p>
<hr/>
<h2 id="7-quy-trinh-cap-nhat-rollback">7. Quy trÃ¬nh cáº­p nháº­t &amp; rollback<a class="headerlink" href="#7-quy-trinh-cap-nhat-rollback" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas sá»­ dá»¥ng CI/CD Ä‘á»ƒ triá»ƒn khai dá»‹ch vá»¥ lÃªn Cloud Run. Má»—i láº§n cáº­p nháº­t Ä‘á»u táº¡o ra má»™t báº£n phÃ¡t hÃ nh má»›i (revision) vÃ  cÃ³ thá»ƒ rollback vá» báº£n cÅ© nhanh chÃ³ng náº¿u phÃ¡t sinh sá»± cá»‘.</p>
<hr/>
<h3 id="quy-trinh-cap-nhat">ğŸš€ Quy trÃ¬nh cáº­p nháº­t<a class="headerlink" href="#quy-trinh-cap-nhat" title="Permanent link">Â¶</a></h3>
<ol>
<li>Developer merge code vÃ o nhÃ¡nh <code>dev</code> hoáº·c <code>main</code></li>
<li>GitHub Actions thá»±c hiá»‡n:</li>
<li>Cháº¡y test</li>
<li>Build Docker image â†’ Ä‘áº©y lÃªn Artifact Registry</li>
<li>Deploy Cloud Run service vá»›i revision má»›i</li>
<li>Cloud Run giá»¯ láº¡i toÃ n bá»™ revision Ä‘Ã£ deploy (trá»« khi bá»‹ xÃ³a)</li>
</ol>
<hr/>
<h3 id="kiem-soat-theo-moi-truong">ğŸ“¦ Kiá»ƒm soÃ¡t theo mÃ´i trÆ°á»ng<a class="headerlink" href="#kiem-soat-theo-moi-truong" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>NhÃ¡nh</th>
<th>MÃ´i trÆ°á»ng</th>
<th>Auto Deploy</th>
<th>Require Approval</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dev</code></td>
<td>Staging</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>main</code></td>
<td>Production</td>
<td>âš ï¸ (CÃ³ thá»ƒ báº­t/táº¯t)</td>
<td>âœ… Required</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="rollback-khi-loi">ğŸ›‘ Rollback khi lá»—i<a class="headerlink" href="#rollback-khi-loi" title="Permanent link">Â¶</a></h3>
<p>Náº¿u sau deploy xáº£y ra lá»—i:</p>
<ol>
<li>VÃ o Google Cloud Console â†’ Cloud Run â†’ Service</li>
<li>Chá»n tab <strong>Revisions</strong></li>
<li>Click <strong>Pin traffic</strong> hoáº·c <strong>Rollback</strong> vá» revision trÆ°á»›c Ä‘Ã³</li>
<li>Hoáº·c dÃ¹ng lá»‡nh CLI:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>gcloud<span class="w"> </span>run<span class="w"> </span>services<span class="w"> </span>update-traffic<span class="w"> </span>user-service<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span>--to-revisions<span class="o">=</span>rev-1234<span class="o">=</span><span class="m">100</span>
</span></code></pre></div>
<hr/>
<h3 id="luu-y-khi-kiem-tra-version">ğŸ§ª LÆ°u Ã½ khi kiá»ƒm tra version<a class="headerlink" href="#luu-y-khi-kiem-tra-version" title="Permanent link">Â¶</a></h3>
<ul>
<li>Má»—i revision cÃ³ label: <code>git_sha</code>, <code>build_time</code></li>
<li>Gateway hoáº·c cÃ¡c service cÃ³ thá»ƒ tráº£ <code>X-Revision-ID</code> trong header</li>
<li>CÃ³ thá»ƒ táº¡o endpoint <code>/__version__</code> tráº£ vá» git commit + thá»i gian build</li>
</ul>
<hr/>
<h3 id="nhung-rui-ro-can-chu-y">âš ï¸ Nhá»¯ng rá»§i ro cáº§n chÃº Ã½<a class="headerlink" href="#nhung-rui-ro-can-chu-y" title="Permanent link">Â¶</a></h3>
<ul>
<li>Rollback logic cÃ³ thá»ƒ khÃ´ng rollback Ä‘Æ°á»£c DB schema â†’ dÃ¹ng <code>alembic downgrade</code> náº¿u cáº§n</li>
<li>Cache hoáº·c RBAC cÃ³ thá»ƒ cáº§n invalidate náº¿u rollback auth/user</li>
<li>Náº¿u sá»­ dá»¥ng secret má»›i trong phiÃªn báº£n má»›i â†’ rollback pháº£i Ä‘áº£m báº£o backward-compatible</li>
</ul>
<hr/>
<h3 id="zero-downtime-deployment-canary-release-cloud-run">âœ¨ Zero Downtime Deployment &amp; Canary Release (Cloud Run)<a class="headerlink" href="#zero-downtime-deployment-canary-release-cloud-run" title="Permanent link">Â¶</a></h3>
<p>Cloud Run há»— trá»£ triá»ƒn khai <strong>khÃ´ng downtime</strong> báº±ng cÃ¡ch tá»± Ä‘á»™ng route traffic sang revision má»›i sau khi build &amp; deploy thÃ nh cÃ´ng. Báº¡n khÃ´ng cáº§n cáº¥u hÃ¬nh load balancer phá»©c táº¡p nhÆ° VM/Container truyá»n thá»‘ng.</p>
<p><strong>Chiáº¿n lÆ°á»£c triá»ƒn khai cÃ³ thá»ƒ Ã¡p dá»¥ng:</strong></p>
<h4 id="1-all-or-nothing-mac-inh">âœ… 1. All-or-nothing (Máº·c Ä‘á»‹nh)<a class="headerlink" href="#1-all-or-nothing-mac-inh" title="Permanent link">Â¶</a></h4>
<ul>
<li>Sau khi deploy, toÃ n bá»™ traffic Ä‘Æ°á»£c chuyá»ƒn sang revision má»›i.</li>
<li>Náº¿u cÃ³ sá»± cá»‘, rollback vá» revision cÅ© báº±ng lá»‡nh:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>gcloud<span class="w"> </span>run<span class="w"> </span>services<span class="w"> </span>update-traffic<span class="w"> </span>my-service<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">  </span>--to-revisions<span class="o">=</span>rev-abc123<span class="o">=</span><span class="m">100</span>
</span></code></pre></div></li>
</ul>
<h4 id="2-canary-release-traffic-splitting">ğŸ§ª 2. Canary Release (Traffic Splitting)<a class="headerlink" href="#2-canary-release-traffic-splitting" title="Permanent link">Â¶</a></h4>
<ul>
<li>Cho phÃ©p chia traffic giá»¯a revision cÅ© vÃ  má»›i (VD: 90% - 10%)</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>gcloud<span class="w"> </span>run<span class="w"> </span>services<span class="w"> </span>update-traffic<span class="w"> </span>my-service<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="w">  </span>--to-revisions<span class="o">=</span>rev-old<span class="o">=</span><span class="m">90</span>,rev-new<span class="o">=</span><span class="m">10</span>
</span></code></pre></div>
<ul>
<li>Theo dÃµi metric (error rate, latency) trong vÃ i phÃºt, sau Ä‘Ã³ tÄƒng dáº§n lÃªn 100%.</li>
</ul>
<h4 id="luu-y_2">ğŸ›¡ï¸ LÆ°u Ã½:<a class="headerlink" href="#luu-y_2" title="Permanent link">Â¶</a></h4>
<ul>
<li>Má»—i revision lÃ  má»™t phiÃªn báº£n Ä‘á»™c láº­p (immutable).</li>
<li>Äáº£m báº£o backward compatibility trong DB schema náº¿u cáº§n rollback.</li>
<li>CÃ³ thá»ƒ tá»± Ä‘á»™ng hÃ³a canary via GitHub Actions + monitoring alert.</li>
</ul>
<p>ğŸ“Œ Canary release giÃºp giáº£m rá»§i ro sáº£n xuáº¥t â€“ ráº¥t phÃ¹ há»£p cho cÃ¡c service nháº¡y cáº£m (nhÆ° User Service, Notification).</p>
<hr/>
<p>ğŸ“ HÆ°á»›ng dáº«n CI/CD chi tiáº¿t: <a href="../dev-guide/#8-quy-trÃ¬nh-test--ci-cd">Dev Guide</a></p>
<p>ğŸ“ Checklist sá»± cá»‘: <a href="#11-á»©ng-phÃ³-sá»±-cá»‘--khÃ´i-phá»¥c">Má»¥c 11 â€“ á»¨ng phÃ³ sá»± cá»‘</a></p>
<hr/>
<h2 id="8-quan-ly-pubsub-dead-letter">8. Quáº£n lÃ½ Pub/Sub &amp; Dead Letter<a class="headerlink" href="#8-quan-ly-pubsub-dead-letter" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas sá»­ dá»¥ng Google Cloud Pub/Sub Ä‘á»ƒ truyá»n sá»± kiá»‡n báº¥t Ä‘á»“ng bá»™ giá»¯a cÃ¡c service (Notification, Sync, Audit...). Má»—i topic cÃ³ Ã­t nháº¥t má»™t subscription. Náº¿u xá»­ lÃ½ lá»—i hoáº·c timeout, message sáº½ Ä‘Æ°á»£c chuyá»ƒn sang Dead Letter Topic (DLT).</p>
<hr/>
<h3 id="cac-topic-chinh">ğŸ” CÃ¡c topic chÃ­nh<a class="headerlink" href="#cac-topic-chinh" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Publisher</th>
<th>Subscriber</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>notification-events</code></td>
<td>CRM, SIS, Gateway</td>
<td>Notification Service</td>
<td>Gá»­i thÃ´ng bÃ¡o theo sá»± kiá»‡n</td>
</tr>
<tr>
<td><code>user-events</code></td>
<td>Auth, CRM</td>
<td>User Service</td>
<td>Äá»“ng bá»™ tráº¡ng thÃ¡i, RBAC</td>
</tr>
<tr>
<td><code>sync-events</code></td>
<td>CRM Adapter</td>
<td>SIS Adapter, LMS Adapter</td>
<td>Äá»“ng bá»™ há»c sinh sau tuyá»ƒn sinh</td>
</tr>
<tr>
<td><code>audit-events</code></td>
<td>All</td>
<td>Audit Logger</td>
<td>Ghi nháº­n hÃ nh vi nháº¡y cáº£m</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="dead-letter-topics-dlt">ğŸ“¦ Dead Letter Topics (DLT)<a class="headerlink" href="#dead-letter-topics-dlt" title="Permanent link">Â¶</a></h3>
<p>Má»—i subscription Ä‘á»u cÃ³ cáº¥u hÃ¬nh DLT Ä‘i kÃ¨m, vÃ­ dá»¥:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>gcloud<span class="w"> </span>pubsub<span class="w"> </span>subscriptions<span class="w"> </span>update<span class="w"> </span>my-subscription<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">  </span>--dead-letter-topic<span class="o">=</span>projects/<span class="nv">$PROJECT_ID</span>/topics/my-sub-dlt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">  </span>--max-delivery-attempts<span class="o">=</span><span class="m">5</span>
</span></code></pre></div>
<p>Khi message retry quÃ¡ 5 láº§n â†’ chuyá»ƒn sang DLT â†’ log láº¡i sá»± kiá»‡n lá»—i.</p>
<hr/>
<h3 id="giam-sat-pubsub">ğŸ” GiÃ¡m sÃ¡t Pub/Sub<a class="headerlink" href="#giam-sat-pubsub" title="Permanent link">Â¶</a></h3>
<ul>
<li>
<p>Sá»­ dá»¥ng metric:</p>
</li>
<li>
<p><code>num_undelivered_messages</code></p>
</li>
<li><code>ack_latency</code></li>
<li><code>dead_letter_message_count</code></li>
<li>
<p>CÃ³ thá»ƒ táº¡o alert khi:</p>
</li>
<li>
<p>DLT tÄƒng Ä‘á»™t biáº¿n</p>
</li>
<li>Tá»“n Ä‘á»ng nhiá»u message chÆ°a xá»­ lÃ½</li>
<li>Dashboard: <code>pubsub-dashboard</code>, <code>notification-dlt-dashboard</code></li>
</ul>
<hr/>
<h3 id="handling-retry">ğŸ›  Handling retry<a class="headerlink" href="#handling-retry" title="Permanent link">Â¶</a></h3>
<ul>
<li>Logic subscriber cáº§n <strong>idempotent</strong> (xá»­ lÃ½ láº¡i khÃ´ng gÃ¢y lá»—i)</li>
<li>DÃ¹ng <code>message_id</code> Ä‘á»ƒ detect duplicate</li>
<li>Náº¿u sá»­ dá»¥ng database â†’ dÃ¹ng transaction + retry-safe query</li>
</ul>
<hr/>
<h3 id="debug-dlt-message">âœï¸ Debug DLT message<a class="headerlink" href="#debug-dlt-message" title="Permanent link">Â¶</a></h3>
<ol>
<li>Subscribe táº¡m thá»i vÃ o DLT</li>
<li>Ghi log ná»™i dung message Ä‘á»ƒ phÃ¢n tÃ­ch</li>
<li>Quyáº¿t Ä‘á»‹nh: sá»­a lá»—i source, hoáº·c re-publish message (tháº­n trá»ng)</li>
</ol>
<hr/>
<p>ğŸ“ VÃ­ dá»¥ triá»ƒn khai subscriber: <a href="https://github.com/vas-org/dx-notification-service/tree/main/app/events"><code>dx-notification-service</code></a></p>
<p>ğŸ“ SÆ¡ Ä‘á»“ flow: <a href="../../architecture/system-diagrams/#5-data-synchronization-flow--Ä‘á»“ng-bá»™-há»c-sinh-crm--sis--lms">System Diagrams</a></p>
<hr/>
<h2 id="9-kiem-soat-chi-phi-toi-uu-tai-nguyen">9. Kiá»ƒm soÃ¡t chi phÃ­ &amp; tá»‘i Æ°u tÃ i nguyÃªn<a class="headerlink" href="#9-kiem-soat-chi-phi-toi-uu-tai-nguyen" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas sá»­ dá»¥ng nhiá»u dá»‹ch vá»¥ managed (Cloud Run, SQL, Pub/Sub...) â€“ giÃºp váº­n hÃ nh Ä‘Æ¡n giáº£n nhÆ°ng cÅ©ng cáº§n theo dÃµi sÃ¡t Ä‘á»ƒ trÃ¡nh chi phÃ­ vÆ°á»£t kiá»ƒm soÃ¡t. Chi phÃ­ chá»§ yáº¿u phÃ¡t sinh tá»« Cloud Run, Cloud SQL, Pub/Sub, Storage vÃ  Network.</p>
<hr/>
<h3 id="cac-thanh-phan-ton-chi-phi">ğŸ’° CÃ¡c thÃ nh pháº§n tá»‘n chi phÃ­<a class="headerlink" href="#cac-thanh-phan-ton-chi-phi" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Dá»‹ch vá»¥</th>
<th>NhÃ³m chÃ­nh</th>
<th>Chi phÃ­ tÃ­nh theo</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cloud Run</td>
<td>API Gateway, cÃ¡c service</td>
<td>Sá»‘ request, CPU/Memory usage</td>
</tr>
<tr>
<td>Cloud SQL</td>
<td>PostgreSQL, MySQL</td>
<td>Instance uptime + storage</td>
</tr>
<tr>
<td>Redis (MemoryStore)</td>
<td>RBAC cache</td>
<td>GB RAM provisioned</td>
</tr>
<tr>
<td>Pub/Sub</td>
<td>Event-driven flow</td>
<td>Message volume + retention</td>
</tr>
<tr>
<td>GCS</td>
<td>Static assets, backup</td>
<td>GB lÆ°u trá»¯ + truy xuáº¥t</td>
</tr>
<tr>
<td>IAM/Secret Manager</td>
<td>Token, config</td>
<td>Ráº¥t nhá» nhÆ°ng cÃ³ Ä‘á»‹nh má»©c</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="network-egress-costs">ğŸŒ Network Egress Costs<a class="headerlink" href="#network-egress-costs" title="Permanent link">Â¶</a></h3>
<ul>
<li>Cloud Run bá»‹ tÃ­nh phÃ­ <strong>egress</strong> náº¿u gá»i ra ngoÃ i VPC, Ä‘áº·c biá»‡t lÃ :</li>
<li>Gá»i API bÃªn thá»© ba (Zalo, Gmail...)</li>
<li>Truy cáº­p GCS náº¿u khÃ´ng báº­t <strong>Private Google Access</strong></li>
<li>Giao tiáº¿p liÃªn vÃ¹ng (multi-region)</li>
</ul>
<p>ğŸ“Œ CÃ¡ch tá»‘i Æ°u:</p>
<table>
<thead>
<tr>
<th>Giáº£i phÃ¡p</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td>Private Google Access</td>
<td>Cho phÃ©p Cloud Run gá»i GCS/PubSub mÃ  khÃ´ng tÃ­nh egress</td>
</tr>
<tr>
<td>VPC Service Controls</td>
<td>Háº¡n cháº¿ egress trÃ¡i phÃ©p tá»« service ná»™i bá»™</td>
</tr>
<tr>
<td>Region matching</td>
<td>Äáº£m báº£o Redis, SQL, Cloud Run cÃ¹ng region (vd: <code>asia-southeast1</code>)</td>
</tr>
<tr>
<td>API Gateway batching</td>
<td>Gá»™p nhiá»u API outbound thÃ nh 1 request náº¿u Ä‘Æ°á»£c</td>
</tr>
</tbody>
</table>
<blockquote>
<p>âš ï¸ Má»™t sá»‘ quota miá»…n phÃ­ cá»§a GCP khÃ´ng Ã¡p dá»¥ng cho traffic egress giá»¯a vÃ¹ng hoáº·c ra Internet.</p>
</blockquote>
<hr/>
<h3 id="theo-doi-chi-phi">ğŸ“Š Theo dÃµi chi phÃ­<a class="headerlink" href="#theo-doi-chi-phi" title="Permanent link">Â¶</a></h3>
<ul>
<li>Sá»­ dá»¥ng Cloud Billing â†’ Cost Table + Cost Breakdown theo service</li>
<li>Táº¡o <strong>budget alert</strong> qua Billing Budgets:</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>gcloud<span class="w"> </span>billing<span class="w"> </span>budgets<span class="w"> </span>create<span class="w"> </span>--display-name<span class="o">=</span><span class="s2">"VAS Monthly Budget"</span><span class="w"> </span>...
</span></code></pre></div>
<ul>
<li>Gá»­i cáº£nh bÃ¡o qua email hoáº·c Google Chat</li>
</ul>
<hr/>
<h3 id="chien-luoc-toi-uu">ğŸ¯ Chiáº¿n lÆ°á»£c tá»‘i Æ°u<a class="headerlink" href="#chien-luoc-toi-uu" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Dá»‹ch vá»¥</th>
<th>Chiáº¿n lÆ°á»£c</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cloud Run</td>
<td>Set max instance limit, tuning concurrency</td>
</tr>
<tr>
<td>Redis</td>
<td>Chá»‰ cache permission nÃ³ng, TTL ngáº¯n (5â€“10 phÃºt)</td>
</tr>
<tr>
<td>Cloud SQL</td>
<td>Táº¯t instance staging ban Ä‘Ãªm, sá»­ dá»¥ng shared tier náº¿u load tháº¥p</td>
</tr>
<tr>
<td>Pub/Sub</td>
<td>Giáº£m message size, kiá»ƒm tra retry quÃ¡ má»©c</td>
</tr>
<tr>
<td>GCS</td>
<td>XoÃ¡ áº£nh cÅ©/backup quÃ¡ háº¡n, dÃ¹ng <code>lifecycle rule</code></td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="canh-bao-thuc-te">âš ï¸ Cáº£nh bÃ¡o thá»±c táº¿<a class="headerlink" href="#canh-bao-thuc-te" title="Permanent link">Â¶</a></h3>
<ul>
<li>Cloud SQL chiáº¿m ~50% tá»•ng bill náº¿u khÃ´ng tá»‘i Æ°u idle time</li>
<li>Redis billing theo GB RAM provisioned  <blockquote>
<p>ğŸ“Œ dx-vas hiá»‡n sá»­ dá»¥ng <strong>Memorystore for Redis (standard tier, non-cluster)</strong> â€“ khÃ´ng tá»± Ä‘á»™ng scale. Náº¿u cáº§n scaling theo chiá»u ngang, cÃ³ thá»ƒ cÃ¢n nháº¯c nÃ¢ng cáº¥p lÃªn <strong>Memorystore for Redis Cluster</strong>.</p>
</blockquote>
</li>
<li>Pub/Sub cÃ³ thá»ƒ phÃ¡t sinh retry loop gÃ¢y bill áº©n</li>
</ul>
<hr/>
<p>ğŸ“ Theo dÃµi chi phÃ­ chi tiáº¿t: GCP â†’ Billing â†’ Reports</p>
<p>ğŸ“ Cáº£nh bÃ¡o sá»­ dá»¥ng resource: Xem thÃªm <a href="#3-giÃ¡m-sÃ¡t--cáº£nh-bÃ¡o">Má»¥c 3 â€“ GiÃ¡m sÃ¡t &amp; cáº£nh bÃ¡o</a></p>
<hr/>
<h2 id="10-checklist-inh-ky-van-hanh">10. Checklist Ä‘á»‹nh ká»³ váº­n hÃ nh<a class="headerlink" href="#10-checklist-inh-ky-van-hanh" title="Permanent link">Â¶</a></h2>
<p>Viá»‡c kiá»ƒm tra Ä‘á»‹nh ká»³ lÃ  thiáº¿t yáº¿u Ä‘á»ƒ Ä‘áº£m báº£o há»‡ thá»‘ng dx-vas hoáº¡t Ä‘á»™ng an toÃ n, hiá»‡u quáº£ vÃ  khÃ´ng phÃ¡t sinh chi phÃ­ ngoÃ i kiá»ƒm soÃ¡t. Checklist sau Ä‘Ã¢y Ä‘Æ°á»£c chia theo táº§n suáº¥t: hÃ ng tuáº§n, hÃ ng thÃ¡ng vÃ  hÃ ng quÃ½.</p>
<hr/>
<h3 id="hang-tuan">ğŸ” HÃ ng tuáº§n<a class="headerlink" href="#hang-tuan" title="Permanent link">Â¶</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Kiá»ƒm tra Cloud Run error rate â‰¥ 5%</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> XÃ¡c minh cÃ¡c alert Pub/Sub/Redis cÃ³ bá»‹ miss khÃ´ng</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Xem láº¡i DLT logs â†’ xá»­ lÃ½ message fail láº·p láº¡i</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Kiá»ƒm tra tráº¡ng thÃ¡i deploy cá»§a cÃ¡c service staging</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check audit log liÃªn quan Ä‘áº¿n RBAC, Auth</li>
</ul>
<hr/>
<h3 id="hang-thang">ğŸ“… HÃ ng thÃ¡ng<a class="headerlink" href="#hang-thang" title="Permanent link">Â¶</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> XoÃ¡ Cloud SQL backups cÅ© (náº¿u khÃ´ng cáº§n thiáº¿t)</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Review budget report â†’ so vá»›i usage thá»±c táº¿</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Rotate JWT signing key (náº¿u báº­t cháº¿ Ä‘á»™ ngáº¯n háº¡n)</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check Cloud Storage â†’ xoÃ¡ áº£nh/file/log quÃ¡ háº¡n</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Cháº¡y láº¡i test E2E: Webform â†’ CRM â†’ SIS â†’ LMS</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Kiá»ƒm tra láº¡i giá»›i háº¡n Cloud Run (max instance, timeout)</li>
</ul>
<hr/>
<h3 id="hang-quy">ğŸ“£ HÃ ng quÃ½<a class="headerlink" href="#hang-quy" title="Permanent link">Â¶</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"/><span class="task-list-indicator"></span></label> RÃ  soÃ¡t IAM roles trÃªn toÃ n bá»™ dá»± Ã¡n</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"/><span class="task-list-indicator"></span></label> ÄÃ¡nh giÃ¡ láº¡i quota cá»§a Redis, Cloud SQL, Pub/Sub</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"/><span class="task-list-indicator"></span></label> Kiá»ƒm thá»­ ká»‹ch báº£n rollback vÃ  DR (Disaster Recovery)</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"/><span class="task-list-indicator"></span></label> ÄÃ¡nh giÃ¡ performance thá»±c táº¿ â†’ Ä‘iá»u chá»‰nh autoscale</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"/><span class="task-list-indicator"></span></label> Cáº­p nháº­t báº£ng permission &amp; roles (RBAC evolution)</li>
</ul>
<hr/>
<h3 id="cach-theo-doi-checklist">ğŸ“Œ CÃ¡ch theo dÃµi checklist<a class="headerlink" href="#cach-theo-doi-checklist" title="Permanent link">Â¶</a></h3>
<ul>
<li>LÆ°u checklist trÃªn Notion/Google Sheet theo ngÃ y</li>
<li>DÃ¹ng Google Calendar Ä‘á»ƒ nháº¯c lá»‹ch Ä‘á»‹nh ká»³</li>
<li>Gáº¯n vÃ o buá»•i há»p ká»¹ thuáº­t hÃ ng thÃ¡ng (KT Sync)</li>
</ul>
<hr/>
<p>ğŸ“ CÃ¡c log há»— trá»£: <a href="#4-logging--trace-phÃ¢n-tÃ¡n">Má»¥c 4 â€“ Logging &amp; Trace</a> </p>
<p>ğŸ“ Chi phÃ­/quota â†’ <a href="#9-kiá»ƒm-soÃ¡t-chi-phÃ­--tá»‘i-Æ°u-tÃ i-nguyÃªn">Má»¥c 9 â€“ Kiá»ƒm soÃ¡t chi phÃ­</a></p>
<hr/>
<h2 id="11-ung-pho-su-co-khoi-phuc">11. á»¨ng phÃ³ sá»± cá»‘ &amp; khÃ´i phá»¥c<a class="headerlink" href="#11-ung-pho-su-co-khoi-phuc" title="Permanent link">Â¶</a></h2>
<p>Trong má»i há»‡ thá»‘ng sáº£n pháº©m, kháº£ nÄƒng pháº£n á»©ng nhanh khi xáº£y ra lá»—i nghiÃªm trá»ng lÃ  yáº¿u tá»‘ sá»‘ng cÃ²n. dx-vas Ã¡p dá»¥ng mÃ´ hÃ¬nh chuáº©n hÃ³a: phÃ¢n loáº¡i sá»± cá»‘, xá»­ lÃ½ theo checklist, ghi nháº­n háº­u kiá»ƒm (postmortem).</p>
<hr/>
<h3 id="vai-tro-trong-quy-trinh-ung-pho-su-co-incident-response-roles">ğŸ§‘â€ğŸš’ Vai trÃ² trong quy trÃ¬nh á»©ng phÃ³ sá»± cá»‘ (Incident Response Roles)<a class="headerlink" href="#vai-tro-trong-quy-trinh-ung-pho-su-co-incident-response-roles" title="Permanent link">Â¶</a></h3>
<p>Khi xáº£y ra sá»± cá»‘ nghiÃªm trá»ng (vÃ­ dá»¥: giÃ¡n Ä‘oáº¡n dá»‹ch vá»¥, máº¥t dá»¯ liá»‡u, sá»± cá»‘ báº£o máº­t), viá»‡c phÃ¢n vai rÃµ rÃ ng giÃºp Ä‘á»™i ngÅ© pháº£n á»©ng nhanh vÃ  hiá»‡u quáº£ hÆ¡n.</p>
<table>
<thead>
<tr>
<th>Vai trÃ²</th>
<th>MÃ´ táº£ nhiá»‡m vá»¥ chÃ­nh</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Incident Commander (IC)</strong></td>
<td>Äiá»u phá»‘i toÃ n bá»™ quy trÃ¬nh á»©ng phÃ³, Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh cuá»‘i cÃ¹ng vá» rollback, escalations.</td>
</tr>
<tr>
<td><strong>Technical Lead (TL)</strong></td>
<td>PhÃ¢n tÃ­ch nguyÃªn nhÃ¢n, Ä‘Æ°a ra hÆ°á»›ng xá»­ lÃ½ ká»¹ thuáº­t, lÃ m viá»‡c trá»±c tiáº¿p vá»›i há»‡ thá»‘ng.</td>
</tr>
<tr>
<td><strong>Communications Lead (Comms)</strong></td>
<td>Gá»­i update ná»™i bá»™, thÃ´ng bÃ¡o tá»›i stakeholder, khÃ¡ch hÃ ng (náº¿u cáº§n).</td>
</tr>
<tr>
<td><strong>Scribe / Logger</strong></td>
<td>Ghi láº¡i timeline xá»­ lÃ½ sá»± cá»‘, action Ä‘Ã£ thá»±c hiá»‡n â€“ phá»¥c vá»¥ postmortem.</td>
</tr>
<tr>
<td><strong>Service Owner (náº¿u khÃ¡c IC)</strong></td>
<td>Cung cáº¥p kiáº¿n thá»©c há»‡ thá»‘ng, chá»‹u trÃ¡ch nhiá»‡m khÃ´i phá»¥c dá»‹ch vá»¥.</td>
</tr>
</tbody>
</table>
<p>ğŸ§­ Trong Ä‘á»™i ngÅ© nhá», má»™t ngÆ°á»i cÃ³ thá»ƒ kiÃªm nhiá»u vai. Tuy nhiÃªn, IC nÃªn luÃ´n lÃ  ngÆ°á»i tÃ¡ch biá»‡t vá»›i thao tÃ¡c ká»¹ thuáº­t Ä‘á»ƒ giá»¯ Ä‘Æ°á»£c "táº§m nhÃ¬n chiáº¿n lÆ°á»£c".</p>
<p>ğŸ“Œ Template postmortem cÃ³ thá»ƒ Ä‘áº·t trong <code>docs/postmortem-template.md</code>.</p>
<hr/>
<h3 id="phan-loai-su-co">ğŸš¨ PhÃ¢n loáº¡i sá»± cá»‘<a class="headerlink" href="#phan-loai-su-co" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Loáº¡i</th>
<th>VÃ­ dá»¥</th>
<th>Pháº£n á»©ng</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸ”¥ Production Outage</td>
<td>Cloud Run 5xx toÃ n há»‡ thá»‘ng</td>
<td>PhÃ¡t Ä‘á»™ng kÃªnh kháº©n cáº¥p</td>
</tr>
<tr>
<td>âš ï¸ Functional Bug</td>
<td>Notification khÃ´ng gá»­i</td>
<td>Theo má»©c Ä‘á»™ nghiÃªm trá»ng</td>
</tr>
<tr>
<td>â± Degraded</td>
<td>Redis timeout, DB latency cao</td>
<td>Theo dÃµi, Ä‘iá»u chá»‰nh autoscale</td>
</tr>
<tr>
<td>ğŸ”’ Security</td>
<td>RÃ² rá»‰ token, táº¥n cÃ´ng brute force</td>
<td>Ngáº¯t táº¡m, rotate credential</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="checklist-phan-ung-nhanh">ğŸ§¯ Checklist pháº£n á»©ng nhanh<a class="headerlink" href="#checklist-phan-ung-nhanh" title="Permanent link">Â¶</a></h3>
<ol>
<li><strong>XÃ¡c nháº­n lá»—i</strong></li>
<li>Ghi nháº­n timestamp + request_id</li>
<li>Check status Cloud Run, Redis, Pub/Sub, GCS</li>
<li><strong>PhÃ¢n loáº¡i lá»—i</strong></li>
<li>Outage / Degraded / Security</li>
<li><strong>KÃ­ch hoáº¡t recovery</strong></li>
<li>Náº¿u lá»—i rollout: Rollback ngay (Xem <a href="#7-quy-trÃ¬nh-cáº­p-nháº­t--rollback">Má»¥c 7</a>)</li>
<li>Náº¿u Redis fail: flush cache + restart service</li>
<li><strong>ThÃ´ng bÃ¡o</strong></li>
<li>Gá»­i update qua Google Chat <code>#dx-ops-alert</code></li>
<li><strong>KhÃ´i phá»¥c táº¡m thá»i</strong></li>
<li>Táº¯t 1 vÃ i feature non-critical náº¿u cáº§n</li>
</ol>
<hr/>
<h3 id="log-cong-cu-ho-tro">ğŸ—‚ Log &amp; cÃ´ng cá»¥ há»— trá»£<a class="headerlink" href="#log-cong-cu-ho-tro" title="Permanent link">Â¶</a></h3>
<ul>
<li>Cloud Run log + trace</li>
<li>Pub/Sub Dead Letter inspection</li>
<li>Redis monitor command</li>
<li>GCS object viewer (xem cáº¥u hÃ¬nh/static lá»—i)</li>
</ul>
<hr/>
<h3 id="postmortem-template">ğŸ“‹ Postmortem template<a class="headerlink" href="#postmortem-template" title="Permanent link">Â¶</a></h3>
<ol>
<li><strong>Sá»± cá»‘:</strong> (mÃ´ táº£ ngáº¯n)</li>
<li><strong>Thá»i gian:</strong> (báº¯t Ä‘áº§u â€“ káº¿t thÃºc)</li>
<li><strong>áº¢nh hÆ°á»Ÿng:</strong> (ngÆ°á»i dÃ¹ng nÃ o? dá»‹ch vá»¥ nÃ o?)</li>
<li><strong>NguyÃªn nhÃ¢n gá»‘c:</strong> (root cause)</li>
<li><strong>Giáº£i phÃ¡p kháº¯c phá»¥c:</strong> (ngáº¯n háº¡n + dÃ i háº¡n)</li>
<li><strong>Ai xá»­ lÃ½ / liÃªn há»‡:</strong> (contact)</li>
</ol>
<blockquote>
<p>âœ… Má»i postmortem cáº§n lÆ°u táº¡i <code>docs/postmortem/</code> dÆ°á»›i repo <code>dx-vas</code></p>
</blockquote>
<hr/>
<p>ğŸ“ CÃ¡ch kiá»ƒm tra sá»± cá»‘ theo trace: <a href="#4-logging--trace-phÃ¢n-tÃ¡n">Má»¥c 4 â€“ Logging &amp; Trace</a> </p>
<p>ğŸ“ Kháº£ nÄƒng rollback: <a href="#7-quy-trÃ¬nh-cáº­p-nháº­t--rollback">Má»¥c 7 â€“ Cáº­p nháº­t &amp; Rollback</a></p>
<hr/>
<h2 id="12-backup-disaster-recovery-dr">12. Backup &amp; Disaster Recovery (DR)<a class="headerlink" href="#12-backup-disaster-recovery-dr" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas Ä‘Æ°á»£c thiáº¿t káº¿ vá»›i kháº£ nÄƒng khÃ´i phá»¥c linh hoáº¡t vÃ  giá»›i háº¡n downtime. Má»—i thÃ nh pháº§n quan trá»ng Ä‘á»u cÃ³ chiáº¿n lÆ°á»£c DR riÃªng, Ä‘áº£m báº£o khÃ´i phá»¥c dá»¯ liá»‡u vÃ  dá»‹ch vá»¥ khi xáº£y ra sá»± cá»‘ lá»›n (máº¥t DB, háº¡ táº§ng, lá»—i logic nghiÃªm trá»ng...).</p>
<hr/>
<h3 id="rto-rpo-muc-tieu">ğŸ¯ RTO &amp; RPO má»¥c tiÃªu<a class="headerlink" href="#rto-rpo-muc-tieu" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>ThÃ nh pháº§n</th>
<th>RTO</th>
<th>RPO</th>
</tr>
</thead>
<tbody>
<tr>
<td>PostgreSQL (Core)</td>
<td>15 phÃºt</td>
<td>5 phÃºt</td>
</tr>
<tr>
<td>Redis (Cache)</td>
<td>5 phÃºt</td>
<td>0 (cháº¥p nháº­n máº¥t cache)</td>
</tr>
<tr>
<td>MySQL (Adapters)</td>
<td>30 phÃºt</td>
<td>15 phÃºt</td>
</tr>
<tr>
<td>Pub/Sub</td>
<td>10 phÃºt</td>
<td>1 phÃºt</td>
</tr>
<tr>
<td>Static (GCS)</td>
<td>30 phÃºt</td>
<td>0 phÃºt</td>
</tr>
</tbody>
</table>
<blockquote>
<p>RTO: Recovery Time Objective<br>
RPO: Recovery Point Objective</br></p>
</blockquote>
<hr/>
<h3 id="backup-chien-luoc">ğŸ“¦ Backup chiáº¿n lÆ°á»£c<a class="headerlink" href="#backup-chien-luoc" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>ThÃ nh pháº§n</th>
<th>PhÆ°Æ¡ng phÃ¡p</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cloud SQL (PostgreSQL, MySQL)</td>
<td>Enable PITR + Scheduled Snapshots</td>
</tr>
<tr>
<td>Redis</td>
<td>KhÃ´ng backup â€“ auto recreate tá»« source</td>
</tr>
<tr>
<td>GCS</td>
<td>Object versioning + lifecycle rule</td>
</tr>
<tr>
<td>Pub/Sub DLT</td>
<td>LÆ°u message fail trong Dead Letter Topic</td>
</tr>
<tr>
<td>Interface Contracts &amp; ADRs</td>
<td>Sync tá»« Git â†’ giá»¯ báº£n chÃ­nh trÃªn <code>dx-vas</code> repo</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="kiem-thu-dr-inh-ky">ğŸ” Kiá»ƒm thá»­ DR Ä‘á»‹nh ká»³<a class="headerlink" href="#kiem-thu-dr-inh-ky" title="Permanent link">Â¶</a></h3>
<ul>
<li>Má»—i quÃ½ thá»±c hiá»‡n drill (giáº£ láº­p sá»± cá»‘)</li>
<li>XÃ³a báº£n ghi DB staging â†’ restore tá»« snapshot</li>
<li>Simulate fail cá»§a Notification hoáº·c Gateway</li>
<li>Äáº£m báº£o khÃ´i phá»¥c service trong khung thá»i gian má»¥c tiÃªu</li>
</ul>
<hr/>
<h3 id="luu-y-bao-mat">ğŸ” LÆ°u Ã½ báº£o máº­t<a class="headerlink" href="#luu-y-bao-mat" title="Permanent link">Â¶</a></h3>
<ul>
<li>Backup GCS pháº£i báº­t encryption at rest</li>
<li>Chá»‰ tÃ i khoáº£n cÃ³ <code>roles/cloudsql.admin</code> má»›i Ä‘Æ°á»£c táº¡o snapshot</li>
<li>Audit access cÃ¡c báº£n backup qua Cloud Audit Log</li>
</ul>
<hr/>
<h3 id="cong-cu-kiem-tra-khoi-phuc">ğŸ§ª CÃ´ng cá»¥ kiá»ƒm tra &amp; khÃ´i phá»¥c<a class="headerlink" href="#cong-cu-kiem-tra-khoi-phuc" title="Permanent link">Â¶</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="c1"># Liá»‡t kÃª backup</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>gcloud<span class="w"> </span>sql<span class="w"> </span>backups<span class="w"> </span>list<span class="w"> </span>--instance<span class="o">=</span>dx-user-postgres
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a>
</span><span id="__span-12-4"><a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="c1"># Restore tá»« backup</span>
</span><span id="__span-12-5"><a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a>gcloud<span class="w"> </span>sql<span class="w"> </span>instances<span class="w"> </span>restore-backup<span class="w"> </span>dx-user-postgres<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-6"><a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">  </span>--backup-id<span class="o">=</span><span class="m">1234567890</span>
</span></code></pre></div>
<hr/>
<h3 id="vi-du-kich-ban-dr-mat-ket-noi-cloud-sql">ğŸ§ª VÃ­ dá»¥: Ká»‹ch báº£n DR â€“ Máº¥t káº¿t ná»‘i Cloud SQL<a class="headerlink" href="#vi-du-kich-ban-dr-mat-ket-noi-cloud-sql" title="Permanent link">Â¶</a></h3>
<p><strong>TÃ¬nh huá»‘ng:</strong> Cloud SQL instance (PostgreSQL) cho <code>user-service</code> bá»‹ máº¥t káº¿t ná»‘i do lá»—i khu vá»±c (region) hoáº·c lá»—i cáº¥u hÃ¬nh.</p>
<h4 id="cac-buoc-khoi-phuc">ğŸ› ï¸ CÃ¡c bÆ°á»›c khÃ´i phá»¥c:<a class="headerlink" href="#cac-buoc-khoi-phuc" title="Permanent link">Â¶</a></h4>
<ol>
<li><strong>XÃ¡c Ä‘á»‹nh lá»—i:</strong></li>
<li>Kiá»ƒm tra Cloud Monitoring â†’ Metric <code>database/connection_count</code>, <code>availability</code>.</li>
<li>
<p>Kiá»ƒm tra <code>gcloud sql instances describe</code> Ä‘á»ƒ xÃ¡c nháº­n tÃ¬nh tráº¡ng.</p>
</li>
<li>
<p><strong>KÃ­ch hoáº¡t DR Plan:</strong></p>
</li>
<li>Truy cáº­p Cloud SQL snapshot Ä‘á»‹nh ká»³ (PITR hoáº·c báº£n sao).</li>
<li>Táº¡o láº¡i instance táº¡i region khÃ¡c (hoáº·c cÃ¹ng region náº¿u do cáº¥u hÃ¬nh).</li>
</ol>
<p><code>bash
   gcloud sql instances create user-db-dr \
     --region=asia-southeast2 \
     --database-version=POSTGRES_14 \
     --source-instance=user-db \
     --restore-backup=auto</code></p>
<ol>
<li>
<p><strong>Cáº­p nháº­t Cloud Run ENV:</strong></p>
</li>
<li>
<p>Trá» <code>DATABASE_URL</code> cá»§a <code>user-service</code> sang instance má»›i.</p>
</li>
<li>Redeploy service:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>gcloud<span class="w"> </span>run<span class="w"> </span>services<span class="w"> </span>update<span class="w"> </span>user-service<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-2"><a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">  </span>--set-env-vars<span class="o">=</span><span class="nv">DATABASE_URL</span><span class="o">=</span>postgresql://...
</span></code></pre></div>
<ol>
<li>
<p><strong>Kiá»ƒm tra á»©ng dá»¥ng:</strong></p>
</li>
<li>
<p>Kiá»ƒm tra tráº¡ng thÃ¡i Cloud Run revision má»›i.</p>
</li>
<li>
<p>Cháº¡y smoke test hoáº·c cÃ¡c health endpoint.</p>
</li>
<li>
<p><strong>ThÃ´ng bÃ¡o &amp; ghi nháº­n:</strong></p>
</li>
<li>
<p>Gá»­i thÃ´ng bÃ¡o há»‡ thá»‘ng Ä‘Ã£ khÃ´i phá»¥c.</p>
</li>
<li>Log Ä‘áº§y Ä‘á»§ action &amp; thá»i gian vÃ o sá»± kiá»‡n DR.</li>
</ol>
<p>ğŸ“Œ <strong>LÆ°u Ã½:</strong></p>
<ul>
<li>NÃªn chuáº©n bá»‹ sáºµn script DR cho tá»«ng service hoáº·c dá»‹ch vá»¥ CSDL.</li>
<li>CÃ³ thá»ƒ sá»­ dá»¥ng <strong>Terraform</strong> Ä‘á»ƒ Ä‘á»‹nh nghÄ©a sáºµn cáº¥u hÃ¬nh DR infra.</li>
<li>Má»i sá»± kiá»‡n DR pháº£i Ä‘Æ°á»£c diá»…n táº­p Ä‘á»‹nh ká»³.</li>
</ul>
<hr/>
<p>ğŸ“ Ká»‹ch báº£n sá»± cá»‘ toÃ n cá»¥m: <a href="#11-á»©ng-phÃ³-sá»±-cá»‘--khÃ´i-phá»¥c">Má»¥c 11 â€“ á»¨ng phÃ³ sá»± cá»‘ &amp; khÃ´i phá»¥c</a></p>
<p>ğŸ“ Cáº¥u trÃºc triá»ƒn khai dá»‹ch vá»¥: <a href="../../architecture/system-diagrams/#9-deployment-overview-diagram--sÆ¡-Ä‘á»“-triá»ƒn-khai-tá»•ng-quan">System Diagrams</a></p>
<hr/>
<h2 id="13-security-audit-compliance">13. Security audit &amp; compliance<a class="headerlink" href="#13-security-audit-compliance" title="Permanent link">Â¶</a></h2>
<p>Há»‡ thá»‘ng dx-vas Ã¡p dá»¥ng cÆ¡ cháº¿ kiá»ƒm soÃ¡t báº£o máº­t cháº·t cháº½ ngay tá»« kiáº¿n trÃºc. Äá»™i DevOps/SRE cáº§n duy trÃ¬ cÃ¡c hoáº¡t Ä‘á»™ng audit Ä‘á»‹nh ká»³ Ä‘á»ƒ phÃ¡t hiá»‡n lá»— há»•ng, kiá»ƒm soÃ¡t phÃ¢n quyá»n vÃ  Ä‘áº£m báº£o tuÃ¢n thá»§ theo cÃ¡c tiÃªu chuáº©n báº£o máº­t ná»™i bá»™.</p>
<hr/>
<h3 id="kiem-tra-inh-ky">ğŸ” Kiá»ƒm tra Ä‘á»‹nh ká»³<a class="headerlink" href="#kiem-tra-inh-ky" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>NhÃ³m</th>
<th>HÃ nh Ä‘á»™ng</th>
</tr>
</thead>
<tbody>
<tr>
<td>IAM</td>
<td>RÃ  soÃ¡t service account, roles khÃ´ng dÃ¹ng</td>
</tr>
<tr>
<td>Secret</td>
<td>XÃ¡c minh secret háº¿t háº¡n, rotate Ä‘Ãºng lá»‹ch</td>
</tr>
<tr>
<td>RBAC</td>
<td>So khá»›p permission â†’ role â†’ user</td>
</tr>
<tr>
<td>Log</td>
<td>Kiá»ƒm tra trace báº¥t thÆ°á»ng, login fail</td>
</tr>
<tr>
<td>Infra</td>
<td>Check port má»Ÿ, endpoint public (Cloud Run, Redis)</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="lich-audit-goi-y">ğŸ“… Lá»‹ch audit gá»£i Ã½<a class="headerlink" href="#lich-audit-goi-y" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Táº§n suáº¥t</th>
<th>HÃ nh Ä‘á»™ng</th>
</tr>
</thead>
<tbody>
<tr>
<td>HÃ ng thÃ¡ng</td>
<td>RÃ  IAM role, xÃ³a service account cÅ©</td>
</tr>
<tr>
<td>HÃ ng quÃ½</td>
<td>Rotate JWT secret, kiá»ƒm tra RBAC file</td>
</tr>
<tr>
<td>6 thÃ¡ng</td>
<td>Penetration test ná»™i bá»™ (black box / white box)</td>
</tr>
<tr>
<td>HÃ ng nÄƒm</td>
<td>Audit toÃ n há»‡ thá»‘ng, backup policy, access policy</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="cong-cu-ho-tro-audit">ğŸ›  CÃ´ng cá»¥ há»— trá»£ audit<a class="headerlink" href="#cong-cu-ho-tro-audit" title="Permanent link">Â¶</a></h3>
<ul>
<li>Google Cloud Asset Inventory (IAM, Secret, API enabled)</li>
<li>GCP IAM Recommender</li>
<li><code>gcloud iam roles list</code>, <code>gcloud secrets versions list</code></li>
<li>Manual RBAC linter vá»›i file <code>permissions.yaml</code></li>
</ul>
<hr/>
<h3 id="compliance-noi-bo">ğŸ”’ Compliance (ná»™i bá»™)<a class="headerlink" href="#compliance-noi-bo" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>YÃªu cáº§u</th>
<th>TÃ¬nh tráº¡ng</th>
</tr>
</thead>
<tbody>
<tr>
<td>RBAC Ä‘Æ°á»£c kiá»ƒm soÃ¡t qua giao diá»‡n &amp; versioned</td>
<td>âœ…</td>
</tr>
<tr>
<td>KhÃ´ng cÃ³ secret náº±m trong repo code</td>
<td>âœ…</td>
</tr>
<tr>
<td>Táº¥t cáº£ dá»‹ch vá»¥ qua Gateway, cÃ³ log RBAC</td>
<td>âœ…</td>
</tr>
<tr>
<td>XoÃ¡ user = inactive + revoke token</td>
<td>âœ…</td>
</tr>
<tr>
<td>CÃ³ log &amp; alert cho hÃ nh vi báº¥t thÆ°á»ng</td>
<td>âœ…</td>
</tr>
</tbody>
</table>
<blockquote>
<p>ğŸ¯ dx-vas hÆ°á»›ng Ä‘áº¿n mÃ´ hÃ¬nh <strong>Security-by-Design</strong> â€“ khÃ´ng xá»­ lÃ½ báº£o máº­t sau cÃ¹ng, mÃ  tÃ­ch há»£p xuyÃªn suá»‘t.</p>
</blockquote>
<hr/>
<p>ğŸ“ ChÃ­nh sÃ¡ch RBAC: <a href="../../architecture/rbac-deep-dive/">RBAC Deep Dive</a> </p>
<p>ğŸ“ Chi tiáº¿t báº£o máº­t triá»ƒn khai: <a href="../../ADR/adr-004-security/"><code>adr-004-security.md</code></a> </p>
<p>ğŸ“ Há»‡ thá»‘ng log giÃ¡m sÃ¡t: <a href="#4-logging--trace-phÃ¢n-tÃ¡n">Má»¥c 4 â€“ Logging &amp; Trace</a></p>
<hr/>
<h2 id="14-cong-cu-dashboard-ho-tro">14. CÃ´ng cá»¥ &amp; dashboard há»— trá»£<a class="headerlink" href="#14-cong-cu-dashboard-ho-tro" title="Permanent link">Â¶</a></h2>
<p>Äá»ƒ há»— trá»£ váº­n hÃ nh há»‡ thá»‘ng dx-vas á»•n Ä‘á»‹nh vÃ  chá»§ Ä‘á»™ng, Ä‘á»™i DevOps cáº§n sá»­ dá»¥ng káº¿t há»£p nhiá»u cÃ´ng cá»¥ giÃ¡m sÃ¡t, quan sÃ¡t, phÃ¢n tÃ­ch log vÃ  kiá»ƒm tra háº¡ táº§ng.</p>
<hr/>
<h3 id="bo-cong-cu-chinh">ğŸ§° Bá»™ cÃ´ng cá»¥ chÃ­nh<a class="headerlink" href="#bo-cong-cu-chinh" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>CÃ´ng cá»¥</th>
<th>Má»¥c Ä‘Ã­ch</th>
<th>Ghi chÃº</th>
</tr>
</thead>
<tbody>
<tr>
<td>Google Cloud Logging</td>
<td>Xem log toÃ n há»‡ thá»‘ng</td>
<td>Filter theo request_id, service</td>
</tr>
<tr>
<td>Cloud Monitoring</td>
<td>Theo dÃµi metric, alert</td>
<td>Äá»‹nh ngÆ°á»¡ng cho Redis, DB, Pub/Sub</td>
</tr>
<tr>
<td>Cloud Trace</td>
<td>Xem trace phÃ¢n tÃ¡n</td>
<td>TÃ¬m request cháº­m, lá»—i chuá»—i</td>
</tr>
<tr>
<td>Cloud SQL Insights</td>
<td>PhÃ¢n tÃ­ch query cháº­m</td>
<td>Há»— trá»£ cáº£ Postgres &amp; MySQL</td>
</tr>
<tr>
<td>Pub/Sub Viewer</td>
<td>Xem backlog, message retry</td>
<td>Kiá»ƒm tra DLT</td>
</tr>
<tr>
<td>Secret Manager</td>
<td>Quáº£n lÃ½ key/token</td>
<td>Audit access</td>
</tr>
<tr>
<td>IAM Recommender</td>
<td>Äá» xuáº¥t giáº£m quyá»n IAM</td>
<td>Audit vai trÃ² khÃ´ng cáº§n thiáº¿t</td>
</tr>
<tr>
<td>Artifact Registry</td>
<td>Quáº£n lÃ½ Docker image</td>
<td>Theo dÃµi size, version deploy</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="dashboard-tham-khao">ğŸ“Š Dashboard tham kháº£o<a class="headerlink" href="#dashboard-tham-khao" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>TÃªn dashboard</th>
<th>Má»¥c tiÃªu</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gateway-dashboard</code></td>
<td>Theo dÃµi tá»‰ lá»‡ lá»—i, Ä‘á»™ trá»… Gateway</td>
</tr>
<tr>
<td><code>auth-dashboard</code></td>
<td>Login rate, OTP fail, token issue</td>
</tr>
<tr>
<td><code>user-dashboard</code></td>
<td>Truy xuáº¥t RBAC, update user</td>
</tr>
<tr>
<td><code>notification-dashboard</code></td>
<td>Gá»­i email/Zalo, theo dÃµi retry</td>
</tr>
<tr>
<td><code>pubsub-dashboard</code></td>
<td>Backlog, fail, DLT monitor</td>
</tr>
<tr>
<td><code>db-performance-dashboard</code></td>
<td>Slow query, connection pool usage</td>
</tr>
<tr>
<td><code>cost-dashboard</code></td>
<td>Tá»•ng chi phÃ­, cáº£nh bÃ¡o vÆ°á»£t budget</td>
</tr>
</tbody>
</table>
<hr/>
<h3 id="bang-lenh-cli-devops-thuong-dung-gcp-cloud-run-pubsub-cloud-sql">ğŸ§° Báº£ng lá»‡nh CLI DevOps thÆ°á»ng dÃ¹ng (GCP â€“ Cloud Run, Pub/Sub, Cloud SQL)<a class="headerlink" href="#bang-lenh-cli-devops-thuong-dung-gcp-cloud-run-pubsub-cloud-sql" title="Permanent link">Â¶</a></h3>
<table>
<thead>
<tr>
<th>Má»¥c Ä‘Ã­ch</th>
<th>Lá»‡nh</th>
</tr>
</thead>
<tbody>
<tr>
<td>Xem revision &amp; traffic cá»§a má»™t service</td>
<td><code>gcloud run services describe user-service --format="value(status.traffic)"</code></td>
</tr>
<tr>
<td>Rollback revision cá»¥ thá»ƒ</td>
<td><code>gcloud run services update-traffic user-service --to-revisions=rev-abc123=100</code></td>
</tr>
<tr>
<td>Kiá»ƒm tra log Cloud Run má»›i nháº¥t</td>
<td><code>gcloud logs read "resource.type=cloud_run_revision" --limit=50</code></td>
</tr>
<tr>
<td>Xem thÃ´ng Ä‘iá»‡p bá»‹ Ä‘áº©y vÃ o DLT</td>
<td><code>gcloud pubsub subscriptions pull user-dlt-sub --limit=5 --auto-ack</code></td>
</tr>
<tr>
<td>Scale min/max instance Cloud Run</td>
<td><code>gcloud run services update user-service --min-instances=1 --max-instances=5</code></td>
</tr>
<tr>
<td>Táº¡o Cloud SQL tá»« backup</td>
<td><code>gcloud sql instances create user-db-dr --restore-backup=1234567890</code></td>
</tr>
<tr>
<td>Truy cáº­p shell PostgreSQL Cloud SQL</td>
<td><code>gcloud sql connect user-db --user=postgres</code></td>
</tr>
<tr>
<td>Kiá»ƒm tra tráº¡ng thÃ¡i Redis</td>
<td><code>gcloud redis instances describe vas-rbac-cache</code></td>
</tr>
</tbody>
</table>
<p>ğŸ“Œ Tham kháº£o file tá»•ng há»£p <a href="./ops-cli-cheatsheet.md">Dev Ops Cheatsheet</a> <em>dá»± kiáº¿n</em>.</p>
<hr/>
<h3 id="uong-dan-huu-ich">ğŸ“ ÄÆ°á»ng dáº«n há»¯u Ã­ch<a class="headerlink" href="#uong-dan-huu-ich" title="Permanent link">Â¶</a></h3>
<ul>
<li><a href="https://console.cloud.google.com/run">Cloud Run logs</a></li>
<li><a href="https://console.cloud.google.com/cloudpubsub/topic/list">Pub/Sub Viewer</a></li>
<li><a href="https://console.cloud.google.com/sql/insights">SQL Insights</a></li>
<li><a href="https://console.cloud.google.com/security/secret-manager">Secret Manager</a></li>
</ul>
<hr/>
<p>ğŸ“ Má»i dashboard nÃªn Ä‘Æ°á»£c lÆ°u trá»¯ version (JSON export) táº¡i:<br>
<code>dx-vas/docs/observability/dashboards/</code></br></p>
<p>ğŸ“ LiÃªn káº¿t CI/CD â€“ xem Dev Guide: <a href="../dev-guide/#8-quy-trÃ¬nh-test--ci-cd">Dev Guide</a></p>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Trá»Ÿ láº¡i má»¥c lá»¥c
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u0110\u00e3 sao ch\u00e9p", "clipboard.copy": "Sao ch\u00e9p v\u00e0o b\u1ed9 nh\u1edb t\u1ea1m", "search.result.more.one": "1 t\u1eeb kh\u00e1c trong trang", "search.result.more.other": "# t\u1eeb kh\u00e1c trong trang", "search.result.none": "Kh\u00f4ng t\u00ecm th\u1ea5y t\u00e0i li\u1ec7u li\u00ean quan", "search.result.one": "1 t\u00e0i li\u1ec7u li\u00ean quan", "search.result.other": "# t\u00e0i li\u1ec7u li\u00ean quan", "search.result.placeholder": "Nh\u1eadp \u0111\u1ec3 b\u1eaft \u0111\u1ea7u t\u00ecm ki\u1ebfm", "search.result.term.missing": "Kh\u00f4ng", "select.version": "Ch\u1ecdn phi\u00ean b\u1ea3n"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body>
</html>